!function(){"use strict";var e="undefined"==typeof global?self:global;if("function"!=typeof e.require){var t={},n={},r={},i={}.hasOwnProperty,o=/^\.\.?(\/|$)/,a=function(e,t){for(var n,r=[],i=(o.test(t)?e+"/"+t:t).split("/"),a=0,s=i.length;a<s;a++)".."===(n=i[a])?r.pop():"."!==n&&""!==n&&r.push(n);return r.join("/")},s=function(e){return e.split("/").slice(0,-1).join("/")},u=function(t,r){var i,o={id:t,exports:{},hot:p&&p.createHot(t)};return n[t]=o,r(o.exports,(i=t,function(t){var n=a(s(i),t);return e.require(n,i)}),o),o.exports},c=function(e){var t=r[e];return t&&e!==t?c(t):e},l=function(e,r){null==r&&(r="/");var o=c(e);if(i.call(n,o))return n[o].exports;if(i.call(t,o))return u(o,t[o]);throw new Error("Cannot find module '"+e+"' from '"+r+"'")};l.alias=function(e,t){r[t]=e};var f=/\.[^.\/]+$/,d=/\/index(\.[^\/]+)?$/;l.register=l.define=function(e,o){if(e&&"object"==typeof e)for(var a in e)i.call(e,a)&&l.register(a,e[a]);else t[e]=o,delete n[e],function(e){if(f.test(e)){var t=e.replace(f,"");i.call(r,t)&&r[t].replace(f,"")!==t+"/index"||(r[t]=e)}if(d.test(e)){var n=e.replace(d,"");i.call(r,n)||(r[n]=e)}}(e)},l.list=function(){var e=[];for(var n in t)i.call(t,n)&&e.push(n);return e};var p=e._hmr&&new e._hmr(function(e,t){return c(a(s(e),t))},l,t,n);l._cache=n,l.hmr=p&&p.wrap,l.brunch=!0,e.require=l}}(),function(){"undefined"==typeof window||window;var e=function(e,t,n){var r={},i=function(t,n){try{return e(n+"/node_modules/"+t)}catch(e){if(-1===e.toString().indexOf("Cannot find module"))throw e;if(-1!==n.indexOf("node_modules")){var o=n.split("/"),a=o.lastIndexOf("node_modules"),s=o.slice(0,a).join("/");return i(t,s)}}return r};return function(o){if(o in t&&(o=t[o]),o){if("."!==o[0]&&n){var a=i(o,n);if(a!==r)return a}return e(o)}}};require.register("curvature/base/Bag.js",function(t,n,r){n=e(n,{},"curvature"),function(){"use strict";function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Bag=void 0;var r=n("./Bindable"),i=n("./Mixin"),o=n("../mixin/EventTargetMixin");function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=l(e);if(t){var i=l(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return c(this,n)}}function c(t,n){if(n&&("object"===e(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(t)}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var f=Symbol("Mapped"),d=Symbol("Has"),p=Symbol("Add"),v=Symbol("Remove"),h=Symbol("Delete"),y=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&s(e,t)}(o,e);var t,n,i=u(o);function o(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(e=i.call(this)).changeCallback=t,e.content=new Map,e.current=0,e.length=0,e.list=r.Bindable.makeBindable([]),e.meta=Symbol("meta"),e.type=void 0,e}return t=o,(n=[{key:"has",value:function(e){return this[f]?this[f].has(e):this[d](e)}},{key:d,value:function(e){return this.content.has(e)}},{key:"add",value:function(e){return this[f]?this[f].add(e):this[p](e)}},{key:p,value:function(e){if(void 0===e||!(e instanceof Object))throw new Error("Only objects may be added to Bags.");if(this.type&&!(e instanceof this.type))throw console.error(this.type,e),new Error("Only objects of type ".concat(this.type," may be added to this Bag."));if(!this.content.has(e)){var t=new CustomEvent("adding",{detail:{item:e}});if(this.dispatchEvent(t)){var n,r=(n=this.current++,Number(n));this.content.set(e,r),this.list[r]=e,this.changeCallback&&this.changeCallback(e,this.meta,o.ITEM_ADDED,r);var i=new CustomEvent("added",{detail:{item:e,id:r}});return this.dispatchEvent(i),this.length=this.size,r}}}},{key:"remove",value:function(e){return this[f]?this[f].remove(e):this[v](e)}},{key:v,value:function(e){if(void 0===e||!(e instanceof Object))throw new Error("Only objects may be removed from Bags.");if(this.type&&!(e instanceof this.type))throw console.error(this.type,e),new Error("Only objects of type ".concat(this.type," may be removed from this Bag."));if(!this.content.has(e))return this.changeCallback&&this.changeCallback(e,this.meta,0,void 0),!1;var t=new CustomEvent("removing",{detail:{item:e}});if(this.dispatchEvent(t)){var n=this.content.get(e);delete this.list[n],this.content.delete(e),this.changeCallback&&this.changeCallback(e,this.meta,o.ITEM_REMOVED,n);var r=new CustomEvent("removed",{detail:{item:e,id:n}});return this.dispatchEvent(r),this.length=this.size,e}}},{key:"delete",value:function(e){if(this[f])return this[f].delete(e);this[h](e)}},{key:h,value:function(e){this.remove(e)}},{key:"map",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(e){return e},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return e},n=new WeakMap,r=new o;return r[f]=this,this.addEventListener("added",function(i){var o=i.detail.item;if(t(o)&&!n.has(o)){var a=e(o);n.set(o,a),r[p](a)}}),this.addEventListener("removed",function(e){var t=e.detail.item;if(n.has(t)){var i=n.get(t);n.delete(t),r[v](i)}}),r}},{key:"size",get:function(){return this.content.size}},{key:"items",value:function(){return Array.from(this.content.entries()).map(function(e){return e[0]})}}])&&a(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),o}(i.Mixin.with(o.EventTargetMixin));t.Bag=y,Object.defineProperty(y,"ITEM_ADDED",{configurable:!1,enumerable:!1,writable:!0,value:1}),Object.defineProperty(y,"ITEM_REMOVED",{configurable:!1,enumerable:!1,writable:!0,value:-1})}()}),require.register("curvature/base/Bindable.js",function(t,n,r){n=e(n,{},"curvature"),function(){"use strict";function e(t,r,i){return(e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}()?Reflect.construct:function(e,t,r){var i=[null];i.push.apply(i,t);var o=new(Function.bind.apply(e,i));return r&&n(o,r.prototype),o}).apply(null,arguments)}function n(e,t){return(n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function r(e){return function(e){if(Array.isArray(e))return a(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||o(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=o(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){u=!0,a=e},f:function(){try{s||null==n.return||n.return()}finally{if(u)throw a}}}}function o(e,t){if(e){if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Object.defineProperty(t,"__esModule",{value:!0}),t.Bindable=void 0;var l=Symbol("ref"),f=Symbol("original"),d=Symbol("deck"),p=Symbol("binding"),v=Symbol("subBinding"),h=Symbol("bindingAll"),y=Symbol("isBindable"),b=Symbol("wrapping"),m=Symbol("Names"),g=Symbol("executing"),w=Symbol("stack"),O=(Symbol("object"),Symbol("wrapped")),x=Symbol("unwrapped"),k=Symbol("getProto"),j=Symbol("onGet"),S=Symbol("onAllGet"),P=Symbol("bindChain"),_=Symbol("Descriptors"),C=Symbol("Before"),T=Symbol("After"),E=Symbol("NoGetters"),A=Object.getPrototypeOf(Int8Array),R=Set.prototype[Symbol.iterator],M=Map.prototype[Symbol.iterator],z=globalThis,I=[z.Node,z.File,z.Map,z.Set,z.WeakMap,z.WeakSet,z.ArrayBuffer,z.ResizeObserver,z.MutationObserver,z.PerformanceObserver,z.IntersectionObserver,z.IDBCursor,z.IDBCursorWithValue,z.IDBDatabase,z.IDBFactory,z.IDBIndex,z.IDBKeyRange,z.IDBObjectStore,z.IDBOpenDBRequest,z.IDBRequest,z.IDBTransaction,z.IDBVersionChangeEvent,z.Event,z.CustomEvent,z.FileSystemFileHandle].filter(function(e){return"function"==typeof e}),B=function(){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t)}var n,o;return n=t,o=[{key:"isBindable",value:function(e){return!(!e||!e[y])&&e[y]===t}},{key:"onDeck",value:function(e,t){return e[d][t]||!1}},{key:"ref",value:function(e){return e[l]||e||!1}},{key:"makeBindable",value:function(e){return this.make(e)}},{key:"shuck",value:function(e,n){n=n||new Map;var r={};if(e instanceof A||e instanceof ArrayBuffer){var i=e.slice(0);return n.set(e,i),i}var o=Object.keys(e);for(var a in o){var u=o[a];if("___"!==u.substring(0,3)){var c=n.get(e[u]);if(c)r[u]=c;else if(e[u]!==e){if(e[u]&&"object"===s(e[u])){var l=e[u];t.isBindable(e[u])&&(l=e[u][f]),r[u]=this.shuck(l,n)}else r[u]=e[u];n.set(e[u],r[u])}else n.set(e[u],r),r[u]=r}}return t.isBindable(e)&&(delete r.bindTo,delete r.isBound),r}},{key:"make",value:function(n){var o=this;if(!n||!["function","object"].includes(s(n)))return n;if(n[l])return n[l];if(n[y])return n;if(Object.isSealed(n)||Object.isFrozen(n)||!Object.isExtensible(n)||I.filter(function(e){return n instanceof e}).length)return n;Object.defineProperty(n,y,{configurable:!1,enumerable:!1,writable:!1,value:t}),Object.defineProperty(n,l,{configurable:!0,enumerable:!1,writable:!0,value:!1}),Object.defineProperty(n,f,{configurable:!1,enumerable:!1,writable:!1,value:n}),Object.defineProperty(n,d,{configurable:!1,enumerable:!1,writable:!1,value:{}}),Object.defineProperty(n,p,{configurable:!1,enumerable:!1,writable:!1,value:{}}),Object.defineProperty(n,v,{configurable:!1,enumerable:!1,writable:!1,value:new Map}),Object.defineProperty(n,h,{configurable:!1,enumerable:!1,writable:!1,value:[]}),Object.defineProperty(n,g,{enumerable:!1,writable:!0}),Object.defineProperty(n,b,{enumerable:!1,writable:!0}),Object.defineProperty(n,w,{configurable:!1,enumerable:!1,writable:!1,value:[]}),Object.defineProperty(n,C,{configurable:!1,enumerable:!1,writable:!1,value:[]}),Object.defineProperty(n,T,{configurable:!1,enumerable:!1,writable:!1,value:[]}),Object.defineProperty(n,O,{configurable:!1,enumerable:!1,writable:!1,value:Object.preventExtensions(new Map)}),Object.defineProperty(n,x,{configurable:!1,enumerable:!1,writable:!1,value:{}}),Object.defineProperty(n,_,{configurable:!1,enumerable:!1,writable:!1,value:Object.preventExtensions(new Map)}),Object.defineProperty(n,"bindTo",{configurable:!1,enumerable:!1,writable:!1,value:function e(r){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},u=!1;if(Array.isArray(r)){var c=r.forEach(function(t){return e(t,i,a)});return function(){return c.forEach(function(e){return e()})}}if(r instanceof Function&&(a=i||{},i=r,u=!0),a.delay>=0&&(i=o.wrapDelayCallback(i,a.delay)),a.throttle>=0&&(i=o.wrapThrottleCallback(i,a.throttle)),a.wait>=0&&(i=o.wrapWaitCallback(i,a.wait)),a.frame&&(i=o.wrapFrameCallback(i,a.frame)),a.idle&&(i=o.wrapIdleCallback(i)),u){var l=n[h].length;if(n[h].push(i),!("now"in a)||a.now)for(var f in n)i(n[f],f,n,!1);return function(){delete n[h][l]}}if(n[p][r]||(n[p][r]=new Set),a.children){var d=i;i=function(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];var o=r[0],u=n[v].get(d);if(u&&(n[v].delete(d),u()),"object"===s(o)){var c=t.make(o);t.isBindable(c)&&n[v].set(d,c.bindTo(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return d.apply(void 0,r.concat(t))},Object.assign({},a,{children:!1}))),d.apply(void 0,r)}else d.apply(void 0,r)}}n[p][r].add(i),"now"in a&&!a.now||i(n[r],r,n,!1);var y=function(){var e=n[v].get(i);e&&(n[v].delete(i),e()),n[p][r]&&n[p][r].has(i)&&n[p][r].delete(i)};return a.removeWith&&a.removeWith instanceof View&&a.removeWith.onRemove(function(){return y}),y}}),Object.defineProperty(n,P,{configurable:!1,enumerable:!1,writable:!1,value:function(e,t){var r=e.split("."),i=r.shift(),a=r.slice(0),s=[];return s.push(n.bindTo(i,function(e,n,r,i){var u=a.join(".");0!==a.length?(void 0===e&&(e=r[n]=o.make({})),s=s.concat(e[P](u,t))):t(e,n,r,i)})),function(){return s.forEach(function(e){return e()})}}}),Object.defineProperty(n,"___before",{configurable:!1,enumerable:!1,writable:!1,value:function(e){var t=n[C].length;n[C].push(e);var r=!1;return function(){r||(r=!0,delete n[C][t])}}}),Object.defineProperty(n,"___after",{configurable:!1,enumerable:!1,writable:!1,value:function(e){var t=n[T].length;n[T].push(e);var r=!1;return function(){r||(r=!0,delete n[T][t])}}}),Object.defineProperty(n,"isBound",{configurable:!1,enumerable:!1,writable:!1,value:function(){for(var e in n[h])if(n[h][e])return!0;for(var t in n[p])for(var r in n[p][t])if(n[p][t][r])return!0;return!1}});var a=function(e){n[e]&&n[e]instanceof Object&&!n[e]instanceof Promise&&(I.filter(function(t){return n[e]instanceof t}).length||!Object.isExtensible(n[e])||Object.isSealed(n[e])||(n[e]=t.make(n[e])))};for(var u in n)a(u);var c=n[_],z=n[O],B=n[w],D={get:function(r,o){if(z.has(o))return z.get(o);if(o===l||o===f||"apply"===o||"isBound"===o||"bindTo"===o||"__proto__"===o||"constructor"===o)return n[o];var a;if(c.has(o)?a=c.get(o):(a=Object.getOwnPropertyDescriptor(n,o),c.set(o,a)),a&&!a.configurable&&!a.writable)return n[o];if(S in n)return n[S](o);if(j in n&&!(o in n))return n[j](o);if(a&&!a.configurable&&!a.writable)return z.set(o,n[o]),n[o];if("function"==typeof n[o]){if(m in n[o])return n[o];Object.defineProperty(n[x],o,{configurable:!1,enumerable:!1,writable:!0,value:n[o]});var s=Object.getPrototypeOf(n)[o]===n[o],u="function"==typeof Promise&&n instanceof Promise||"function"==typeof Map&&n instanceof Map||"function"==typeof Set&&n instanceof Set||"function"==typeof M&&n.prototype===M||"function"==typeof R&&n.prototype===R||"function"==typeof R&&n.prototype===R||"function"==typeof WeakMap&&n instanceof WeakMap||"function"==typeof WeakSet&&n instanceof WeakSet||"function"==typeof Date&&n instanceof Date||"function"==typeof A&&n instanceof A||"function"==typeof ArrayBuffer&&n instanceof ArrayBuffer||"function"==typeof EventTarget&&n instanceof EventTarget||"function"==typeof ResizeObserver&&n instanceof ResizeObserver||"function"==typeof MutationObserver&&n instanceof MutationObserver||"function"==typeof PerformanceObserver&&n instanceof PerformanceObserver||"function"==typeof IntersectionObserver&&n instanceof IntersectionObserver||"function"==typeof n[Symbol.iterator]&&"next"===o?n:n[l],d=function(){n[g]=o,B.unshift(o);for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];var c,l,f=i(n[C]);try{for(f.s();!(c=f.n()).done;){(0,c.value)(n,o,B,n,r)}}catch(e){f.e(e)}finally{f.f()}if(new.target)l=e(n[x][o],r);else{var d=n[x][o];l=s?d.apply(u||n,r):d.apply(void 0,r)}var p,v=i(n[T]);try{for(v.s();!(p=v.n()).done;){(0,p.value)(n,o,B,n,r)}}catch(e){v.e(e)}finally{v.f()}return n[g]=null,B.shift(),l};(d[m]=d[m]||new WeakMap).set(n,o),d[S]=function(e){var t=d[m].get(n);return n[t][e]};var p=t.make(d);return z.set(o,p),p}return n[o]},set:function(e,r,o){if(z.has(r)&&z.delete(r),r===f)return!0;var a=n[d];if(r in a&&a[r]===o)return!0;if(r.slice&&"___"===r.slice(-3))return!0;if(e[r]===o||"number"==typeof o&&isNaN(a[r])&&isNaN(o))return!0;for(var s in o&&o instanceof Object&&(I.filter(function(e){return n instanceof e}).length||!Object.isExtensible(n)||Object.isSealed(n)||(n[E],o=t.make(o))),a[r]=o,n[h])n[h][s]&&n[h][s](o,r,e,!1);var u=!1;if(r in n[p]){var c,l=i(n[p][r]);try{for(l.s();!(c=l.n()).done;)!1===(0,c.value)(o,r,e,!1,e[r])&&(u=!0)}catch(e){l.e(e)}finally{l.f()}}if(delete a[r],!u){var v=Object.getOwnPropertyDescriptor(e,r);e instanceof File&&"lastModifiedDate"==r||v&&!v.writable||e[r]!==o||(e[r]=o)}var y=Reflect.set(e,r,o);if(Array.isArray(e)&&n[p].length)for(var b in n[p].length)(0,n[p].length[b])(e.length,"length",e,!1,e.length);return y},construct:function(i,o){var a="constructor";for(var s in i[C])i[C][s](i,a,n[w],void 0,o);var u=t.make(e(i[f],r(o)));for(var c in i[T])i[T][c](i,a,n[w],u,o);return u},getPrototypeOf:function(e){return k in n?n[k]:Reflect.getPrototypeOf(e)},deleteProperty:function(e,t){var r=n[d];if(void 0!==r[t])return!0;if(!(t in e))return!0;if(c.has(t)){var o=c.get(t);if(o&&!o.configurable)return!1;c.delete(t)}for(var a in r[t]=null,z.has(t)&&z.delete(t),n[h])n[h][a](void 0,t,e,!0,e[t]);if(t in n[p]){var s,u=i(n[p][t]);try{for(u.s();!(s=u.n()).done;)(0,s.value)(void 0,t,e,!0,e[t])}catch(e){u.e(e)}finally{u.f()}}return delete r[t],delete e[t],!0}};return n[E]&&delete D.get,Object.defineProperty(n,l,{configurable:!1,enumerable:!1,writable:!1,value:new Proxy(n,D)}),n[l]}},{key:"clearBindings",value:function(e){var t;(t=function(e){return Object.keys(e).map(function(t){return delete e[t]})},function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return n.map(t)})(e[O],e[p],e[h],e[T],e[C])}},{key:"resolve",value:function(e,t){for(var n,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=t.split("."),o=i[0];i.length;){if(r&&1===i.length)return[this.make(e),i.shift(),o];!(!(n=i.shift())in e)&&e[n]&&e[n]instanceof Object||(e[n]={}),e=this.make(e[n])}return[this.make(e),n,o]}},{key:"wrapDelayCallback",value:function(e,t){return function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return setTimeout(function(){return e.apply(void 0,r)},t)}}},{key:"wrapThrottleCallback",value:function(e,t){var n=this;return this.throttles.set(e,!1),function(){n.throttles.get(e,!0)||(e.apply(void 0,arguments),n.throttles.set(e,!0),setTimeout(function(){n.throttles.set(e,!1)},t))}}},{key:"wrapWaitCallback",value:function(e,t){var n=this;return function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];var a;(a=n.waiters.get(e))&&(n.waiters.delete(e),clearTimeout(a)),a=setTimeout(function(){return e.apply(void 0,i)},t),n.waiters.set(e,a)}}},{key:"wrapFrameCallback",value:function(e,t){return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];requestAnimationFrame(function(){return e.apply(void 0,n)})}}},{key:"wrapIdleCallback",value:function(e){return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];(window.requestIdleCallback||requestAnimationFrame)(function(){return e.apply(void 0,n)})}}}],null&&u(n.prototype,null),o&&u(n,o),Object.defineProperty(n,"prototype",{writable:!1}),t}();t.Bindable=B,c(B,"waiters",new WeakMap),c(B,"throttles",new WeakMap),Object.defineProperty(B,"OnGet",{configurable:!1,enumerable:!1,writable:!1,value:j}),Object.defineProperty(B,"NoGetters",{configurable:!1,enumerable:!1,writable:!1,value:E}),Object.defineProperty(B,"GetProto",{configurable:!1,enumerable:!1,writable:!1,value:k}),Object.defineProperty(B,"OnAllGet",{configurable:!1,enumerable:!1,writable:!1,value:S})}()}),require.register("curvature/base/Cache.js",function(t,n,r){n=e(n,{},"curvature"),function(){"use strict";function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(t,"__esModule",{value:!0}),t.Cache=void 0;var n=function(){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t)}var n,r;return n=t,r=[{key:"store",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"standard",i=0;n&&(i=1e3*n+(new Date).getTime()),this.buckets||(this.buckets=new Map),this.buckets.has(r)||this.buckets.set(r,new Map);var o=new CustomEvent("cvCacheStore",{cancelable:!0,detail:{key:e,value:t,expiry:n,bucket:r}});document.dispatchEvent(o)&&this.buckets.get(r).set(e,{value:t,expiration:i})}},{key:"load",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"standard",r=new CustomEvent("cvCacheLoad",{cancelable:!0,detail:{key:e,defaultvalue:t,bucket:n}});if(!document.dispatchEvent(r))return t;if(this.buckets&&this.buckets.has(n)&&this.buckets.get(n).has(e)){var i=this.buckets.get(n).get(e);if(0===i.expiration||i.expiration>(new Date).getTime())return this.buckets.get(n).get(e).value}return t}}],null&&e(n.prototype,null),r&&e(n,r),Object.defineProperty(n,"prototype",{writable:!1}),t}();t.Cache=n}()}),require.register("curvature/base/Config.js",function(t,n,r){n=e(n,{},"curvature"),function(){"use strict";function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(t,"__esModule",{value:!0}),t.Config=void 0;var r={},i=n;try{r=i("/Config").Config||{}}catch(e){!0===globalThis.devMode&&console.error(e)}var o=function(){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t)}var n,r;return n=t,r=[{key:"get",value:function(e){return this.configs[e]}},{key:"set",value:function(e,t){return this.configs[e]=t,this}},{key:"dump",value:function(){return this.configs}},{key:"init",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var r in t){var i=t[r];for(var o in"string"==typeof i&&(i=JSON.parse(i)),i){var a=i[o];return this.configs[o]=a}}return this}}],null&&e(n.prototype,null),r&&e(n,r),Object.defineProperty(n,"prototype",{writable:!1}),t}();t.Config=o,Object.defineProperty(o,"configs",{configurable:!1,enumerable:!1,writable:!1,value:r})}()}),require.register("curvature/base/Dom.js",function(t,n,r){n=e(n,{},"curvature"),function(){"use strict";function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(t,"__esModule",{value:!0}),t.Dom=void 0;var n=function(){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t)}var n,r;return n=t,r=[{key:"mapTags",value:function(e,t,n,r,i){var o=[],a=!0;r&&(a=!1);for(var s=!1,u=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_TEXT,{acceptNode:function(e,n){if(!a){if(e!==r)return NodeFilter.FILTER_SKIP;a=!0}return i&&e===i&&(s=!0),s?NodeFilter.FILTER_SKIP:t?e instanceof Element&&e.matches(t)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT}},!1);u.nextNode();)o.push(n(u.currentNode,u));return o}},{key:"dispatchEvent",value:function(e,n){e.dispatchEvent(n),t.mapTags(e,!1,function(e){e.dispatchEvent(n)})}}],null&&e(n.prototype,null),r&&e(n,r),Object.defineProperty(n,"prototype",{writable:!1}),t}();t.Dom=n}()}),require.register("curvature/base/Mixin.js",function(t,n,r){n=e(n,{},"curvature"),function(){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Mixin=void 0;var e=n("./Bindable");function r(e){return function(e){if(Array.isArray(e))return s(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||a(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=a(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){u=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(u)throw o}}}}function a(e,t){if(e){if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,t):void 0}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return l(e)}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function v(e,t,n){return t&&p(e.prototype,t),n&&p(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var h=Symbol("constructor"),y=(Symbol("mixinList"),function(){function t(){d(this,t)}return v(t,null,[{key:"from",value:function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];return function(n){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(s,e);var a=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=f(e);if(t){var i=f(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return c(this,n)}}(s);function s(){var n;d(this,s);for(var u=arguments.length,f=new Array(u),p=0;p<u;p++)f[p]=arguments[p];var v,h=e.constructor?n=a.call.apply(a,[this].concat(f)):null,y=o(r);try{for(y.s();!(v=y.n()).done;){var b=v.value;switch(b[t.Constructor]&&b[t.Constructor].apply(l(n)),i(b)){case"function":t.mixClass(b,s);break;case"object":t.mixObject(b,l(n))}}}catch(e){y.e(e)}finally{y.f()}return c(n,h)}return v(s)}()}},{key:"make",value:function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var i=n.pop();return t.to.apply(t,[i].concat(n))}},{key:"to",value:function(e){for(var t={},n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];r.map(function(n){switch(i(n)){case"object":Object.assign(t,Object.getOwnPropertyDescriptors(n));break;case"function":Object.assign(t,Object.getOwnPropertyDescriptors(n.prototype))}delete t.constructor,Object.defineProperties(e.prototype,t)})}},{key:"with",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.from.apply(this,[v(function e(){d(this,e)})].concat(t))}},{key:"mixObject",value:function(e,t){var n,r=o(Object.getOwnPropertyNames(e));try{for(r.s();!(n=r.n()).done;){var i=n.value;"function"!=typeof e[i]?t[i]=e[i]:t[i]=e[i].bind(t)}}catch(e){r.e(e)}finally{r.f()}var a,s=o(Object.getOwnPropertySymbols(e));try{for(s.s();!(a=s.n()).done;){var u=a.value;"function"!=typeof e[u]?t[u]=e[u]:t[u]=e[u].bind(t)}}catch(e){s.e(e)}finally{s.f()}}},{key:"mixClass",value:function(e,t){var n,r=o(Object.getOwnPropertyNames(e.prototype));try{for(r.s();!(n=r.n()).done;){var i=n.value;if(!["name","prototype","length"].includes(i)){var a=Object.getOwnPropertyDescriptor(t,i);a&&!a.writable||("function"==typeof e[i]?t.prototype[i]=e.prototype[i].bind(t.prototype):t.prototype[i]=e.prototype[i])}}}catch(e){r.e(e)}finally{r.f()}var s,u=o(Object.getOwnPropertySymbols(e.prototype));try{for(u.s();!(s=u.n()).done;){var c=s.value;"function"==typeof e[c]?t.prototype[c]=e.prototype[c].bind(t.prototype):t.prototype[c]=e.prototype[c]}}catch(e){u.e(e)}finally{u.f()}var l,f=o(Object.getOwnPropertyNames(e));try{var d=function(){var n=l.value;if(["name","prototype","length"].includes(n))return"continue";var r=Object.getOwnPropertyDescriptor(t,n);if(r&&!r.writable)return"continue";if("function"!=typeof e[n])return t[n]=e[n],"continue";var i=t[n]||!1,o=e[n].bind(t);t[n]=function(){return i&&i.apply(void 0,arguments),o.apply(void 0,arguments)}};for(f.s();!(l=f.n()).done;)d()}catch(e){f.e(e)}finally{f.f()}var p,v=o(Object.getOwnPropertySymbols(e));try{var h=function(){var n=p.value;if("function"!=typeof e[n])return t.prototype[n]=e[n],"continue";var r=t[n]||!1,i=e[n].bind(t);t[n]=function(){return r&&r.apply(void 0,arguments),i.apply(void 0,arguments)}};for(v.s();!(p=v.n()).done;)h()}catch(e){v.e(e)}finally{v.f()}}},{key:"mix",value:function(t){for(var n={},i={},a=e.Bindable.makeBindable(t),s=function(e){var t,s=Object.getOwnPropertyNames(e.prototype),u=/^(before|after)__(.+)/,c=o(Object.getOwnPropertyNames(e));try{var l=function(){var i=t.value,o=i.match(u);if(o){switch(o[1]){case"before":a.___before(function(t,n,a,s,u){if(n===o[2])return e[i].bind(s).apply(void 0,r(u))});break;case"after":a.___after(function(t,n,a,s,u){if(n===o[2])return e[i].bind(s).apply(void 0,r(u))})}return"continue"}return n[i]||"function"!=typeof e[i]?"continue":void(n[i]=e[i])};for(c.s();!(t=c.n()).done;)l()}catch(e){c.e(e)}finally{c.f()}var f,d=o(s);try{var p=function(){var t=f.value,n=t.match(u);if(n){switch(n[1]){case"before":a.___before(function(i,o,a,s,u){if(o===n[2])return e.prototype[t].bind(s).apply(void 0,r(u))});break;case"after":a.___after(function(i,o,a,s,u){if(o===n[2])return e.prototype[t].bind(s).apply(void 0,r(u))})}return"continue"}return i[t]||"function"!=typeof e.prototype[t]?"continue":void(i[t]=e.prototype[t])};for(d.s();!(f=d.n()).done;)p()}catch(e){d.e(e)}finally{d.f()}},u=this;u&&u.prototype;u=Object.getPrototypeOf(u))s(u);for(var c in n)t[c]=n[c].bind(t);var l=function(e){t.prototype[e]=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return i[e].apply(this,n)}};for(var f in i)l(f);return a}}]),t}());t.Mixin=y,y.Constructor=h}()}),require.register("curvature/base/Router.js",function(t,n,r){n=e(n,{},"curvature"),function(){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Router=void 0;var e,r=n("./View"),i=(n("./Cache"),n("./Config")),o=n("./Routes");function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);a=!0);}catch(e){s=!0,i=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw i}}return o}}(e,t)||u(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=u(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function u(e,t){if(e){if("string"==typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(e,t):void 0}}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var d=Symbol("NotFound"),p=Symbol("Internal");globalThis.CustomEvent=null!==(e=globalThis.CustomEvent)&&void 0!==e?e:globalThis.Event;var v=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n;return t=e,n=[{key:"wait",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"DOMContentLoaded";(arguments.length>2&&void 0!==arguments[2]?arguments[2]:document).addEventListener(n,function(){t.listen(e)})}},{key:"listen",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.listener=e||this.listener,this.routes=n||e.routes,Object.assign(this.query,this.queryOver({}));var r=function(n){n.preventDefault(),n.state&&"routedId"in n.state?(n.state.routedId<=t.routeCount?(t.history.splice(n.state.routedId),t.routeCount=n.state.routedId):n.state.routedId>t.routeCount&&(t.history.push(n.state.prev),t.routeCount=n.state.routedId),t.state=n.state):null!==t.prevPath&&t.prevPath!==location.pathname&&t.history.push(t.prevPath),"null"!==location.origin?t.match(location.pathname,e):t.match(t.nextPath,e)};window.addEventListener("cvUrlChanged",r),window.addEventListener("popstate",r);var i="null"!==location.origin&&location.pathname+location.search;location.origin&&location.hash&&(i+=location.hash);var o={routedId:this.routeCount,url:location.pathname,prev:this.prevPath};"null"!==location.origin&&history.replaceState(o,null,location.pathname),this.go(!1!==i?i:"/")}},{key:"go",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=i.Config.get("title");n&&(document.title=n);var r={routedId:this.routeCount,prev:this.prevPath,url:location.pathname};-1===t?this.match(e,this.listener,!0):"null"===location.origin?this.nextPath=e:2===t&&location.pathname!==e?history.replaceState(r,null,e):location.pathname!==e&&history.pushState(r,null,e),(!t||t<0)&&(!1===t&&(this.path=null),t||("#"===e.substring(0,1)?window.dispatchEvent(new HashChangeEvent("hashchange")):window.dispatchEvent(new CustomEvent("cvUrlChanged")))),this.prevPath=e}},{key:"processRoute",value:function(e,t,n){return"function"==typeof e[t]?e[t].prototype instanceof r.View?new e[t](n):e[t](n):e[t]}},{key:"handleError",value:function(e,t,n,r,i,o,a,s){console.error(e),"undefined"!=typeof document&&document.dispatchEvent(new CustomEvent("cvRouteError",{detail:{error:e,path:o,prev:a,view:i,routes:t,selected:n}}));var u=globalThis.devMode?"Unexpected error: "+String(e):"Unexpected error.";t[p]&&(r[p]=e,u=this.processRoute(t,p,r)),this.update(i,o,u,t,n,r,s)}},{key:"match",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=null,u=!1;if(!0===r&&(u=r),r&&"object"===l(r)&&(u=r.forceRefresh,i=r.event),"undefined"==typeof document||this.path!==e||u){var c="http://example.com";"undefined"!=typeof document&&(c="null"!==location.origin?location.origin:c,this.queryString=location.search);var f=new URL(e,c);e=this.path=f.pathname,"undefined"==typeof document&&(this.queryString=f.search);var p=this.prevPath,v=t&&t.args?t.args.content:null,h=this.routes||t&&t.routes||o.Routes.dump(),y=new URLSearchParams(this.queryString);for(var b in i&&i.request&&(this.request=i.request),Object.keys(this.query))delete this.query[b];var m,g=s(y);try{for(g.s();!(m=g.n()).done;){var w=a(m.value,2),O=w[0],x=w[1];this.query[O]=x}}catch(e){g.e(e)}finally{g.f()}var k={},j=!1,S="";for(var P in"/"===e.substring(0,1)&&(e=e.substring(1)),e=e.split("/"),this.query)k[P]=this.query[P];e:for(var _ in h){var C=_.split("/");if(!(C.length<e.length&&"*"!==C[C.length-1])){for(var T in C)if("%"==C[T].substr(0,1)){var E=null,A=/^%(\w+)\??/.exec(C[T]);if(A&&A[1]&&(E=A[1]),!E)throw new Error("".concat(C[T],' is not a valid argument segment in route "').concat(_,'"'));if(e[T])k[E]=e[T];else{if("?"!=C[T].substr(C[T].length-1,1))continue e;k[E]=""}}else if("*"!==C[T]&&e[T]!==C[T])continue e;j=_,S=h[_],"*"===C[C.length-1]&&(k.pathparts=e.slice(C.length-1));break}}var R=new CustomEvent("cvRouteStart",{cancelable:!0,detail:{path:e,prev:p,root:t,selected:j,routes:h}});if("undefined"==typeof document||document.dispatchEvent(R)){if(!u&&t&&v&&S instanceof Object&&v instanceof S&&!(S instanceof Promise)&&v.update(k))return t.args.content=v,!0;j in h||(h[j]=h[d]);try{return!1===(S=this.processRoute(h,j,k))&&(S=this.processRoute(h,d,k)),S instanceof Promise||(S=Promise.resolve(S)),"undefined"==typeof document?S:S.then(function(r){n.update(t,e,r,h,j,k,u)}).catch(function(r){n.handleError(r,h,j,k,t,e,p,u)})}catch(n){this.handleError(n,h,j,k,t,e,p,u)}}}}},{key:"update",value:function(e,t,n,i,o,a,s){if(e){var u=this.prevPath,c=new CustomEvent("cvRoute",{cancelable:!0,detail:{result:n,path:t,prev:u,view:e,routes:i,selected:o}});!1!==n&&(e.args.content instanceof r.View&&(e.args.content.pause(!0),e.args.content.remove()),document.dispatchEvent(c)&&(e.args.content=n),n instanceof r.View&&(n.pause(!1),n.update(a,s)));var l=new CustomEvent("cvRouteEnd",{cancelable:!0,detail:{result:n,path:t,prev:u,view:e,routes:i,selected:o}});document.dispatchEvent(l)}}},{key:"queryOver",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n={},r={},i=s(new URLSearchParams(location.search));try{for(i.s();!(e=i.n()).done;){var o=e.value;r[o[0]]=o[1]}}catch(e){i.e(e)}finally{i.f()}return delete(n=Object.assign(n,r,t)).api,n}},{key:"queryToString",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=[],r=e;for(var i in t||(r=this.queryOver(e)),r)""!==r[i]&&n.push(i+"="+encodeURIComponent(r[i]));return n.join("&")}},{key:"setQuery",value:function(e,t,n){var r=this.queryOver();r[e]=t,void 0===t&&delete r[e];var i=this.queryToString(r,!0);this.go(location.pathname+(i?"?"+i:"?"),n)}}],null&&f(t.prototype,null),n&&f(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();t.Router=v,Object.defineProperty(v,"query",{configurable:!1,enumerable:!1,writable:!1,value:{}}),Object.defineProperty(v,"history",{configurable:!1,enumerable:!1,writable:!1,value:[]}),Object.defineProperty(v,"routeCount",{configurable:!1,enumerable:!1,writable:!0,value:0}),Object.defineProperty(v,"prevPath",{configurable:!1,enumerable:!1,writable:!0,value:null}),Object.defineProperty(v,"queryString",{configurable:!1,enumerable:!1,writable:!0,value:null}),Object.defineProperty(v,"InternalError",{configurable:!1,enumerable:!1,writable:!1,value:p}),Object.defineProperty(v,"NotFoundError",{configurable:!1,enumerable:!1,writable:!1,value:d})}()}),require.register("curvature/base/Routes.js",function(t,n,r){n=e(n,{},"curvature"),function(){"use strict";function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(t,"__esModule",{value:!0}),t.Routes=void 0;var r={},i=n,o=!1,a=function(){if(!o){try{Object.assign(r,i("Routes").Routes||{})}catch(e){!0===globalThis.devMode&&console.warn(e)}o=!0}},s=function(){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t)}var n,r;return n=t,r=[{key:"get",value:function(e){return a(),this.routes[e]}},{key:"dump",value:function(){return a(),this.routes}}],null&&e(n.prototype,null),r&&e(n,r),Object.defineProperty(n,"prototype",{writable:!1}),t}();t.Routes=s,Object.defineProperty(s,"routes",{configurable:!1,enumerable:!1,writable:!1,value:r})}()}),require.register("curvature/base/RuleSet.js",function(t,n,r){n=e(n,{},"curvature"),function(){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RuleSet=void 0,n("./Dom");var e=n("./Tag"),r=n("./View");function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);a=!0);}catch(e){s=!0,i=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw i}}return o}}(e,t)||a(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=a(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){u=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(u)throw o}}}}function a(e,t){if(e){if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,t):void 0}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var c=function(){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t)}var n,a,s;return n=t,a=[{key:"add",value:function(e,t){return this.rules=this.rules||{},this.rules[e]=this.rules[e]||[],this.rules[e].push(t),this}},{key:"apply",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;for(var r in t.apply(e,n),this.rules)for(var i in this.rules[r]){var a,s=this.rules[r][i],u=t.wrap(e,s,n),c=o(e.querySelectorAll(r));try{for(c.s();!(a=c.n()).done;){u(a.value)}}catch(e){c.e(e)}finally{c.f()}}}},{key:"purge",value:function(){if(this.rules)for(var e=0,t=Object.entries(this.rules);e<t.length;e++){var n=i(t[e],2),r=n[0];if(n[1],this.rules[r])for(var o in this.rules[r])delete this.rules[r][o]}}}],s=[{key:"add",value:function(e,t){return this.globalRules=this.globalRules||{},this.globalRules[e]=this.globalRules[e]||[],this.globalRules[e].push(t),this}},{key:"apply",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;for(var n in this.globalRules)for(var r in this.globalRules[n]){var i,a=this.globalRules[n][r],s=this.wrap(e,a,t),u=o(e.querySelectorAll(n));try{for(u.s();!(i=u.n()).done;){s(i.value)}}catch(e){u.e(e)}finally{u.f()}}}},{key:"wait",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"DOMContentLoaded",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document,r=function(t,n){return function(){return n.removeEventListener(t,r),e.apply()}}(t,n);n.addEventListener(t,r)}},{key:"wrap",value:function(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=n;return(n instanceof r.View||n&&n.prototype&&n.prototype instanceof r.View)&&(o=function(){return n}),function(t){if(void 0===t.___cvApplied___&&Object.defineProperty(t,"___cvApplied___",{enumerable:!1,writable:!1,value:new WeakSet}),!t.___cvApplied___.has(n)){var a,s;i&&(a=s=i,i.viewList&&(s=i.viewList.parent));var u,c=new e.Tag(t,s,null,void 0,a),l=c.element.parentNode,f=c.element.nextSibling,d=o(c);if(!1!==d&&t.___cvApplied___.add(n),d instanceof HTMLElement&&(d=new e.Tag(d)),d instanceof e.Tag){if(!d.element.contains(c.element)){for(;c.element.firstChild;)d.element.appendChild(c.element.firstChild);c.remove()}f?l.insertBefore(d.element,f):l.appendChild(d.element)}d&&d.prototype&&d.prototype instanceof r.View&&(d=new d({},i)),d instanceof r.View&&(i&&(i.cleanup.push((u=d,function(){u.remove()})),i.cleanup.push(i.args.bindTo(function(e,t,n){n[t]=e,d.args[t]=e})),i.cleanup.push(d.args.bindTo(function(e,t,n,r){n[t]=e,i.args[t]=e}))),c.clear(),d.render(c.element))}}}}],a&&u(n.prototype,a),s&&u(n,s),Object.defineProperty(n,"prototype",{writable:!1}),t}();t.RuleSet=c}()}),require.register("curvature/base/SetMap.js",function(t,n,r){n=e(n,{},"curvature"),function(){"use strict";function e(t,r,i){return(e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}()?Reflect.construct:function(e,t,r){var i=[null];i.push.apply(i,t);var o=new(Function.bind.apply(e,i));return r&&n(o,r.prototype),o}).apply(null,arguments)}function n(e,t){return(n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function r(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||i(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){if(e){if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(e,t):void 0}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(t,"__esModule",{value:!0}),t.SetMap=void 0;var s=function(){function t(){var e,n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e=this,n="_map",r=new Map,n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r}var n,o;return n=t,(o=[{key:"has",value:function(e){return this._map.has(e)}},{key:"get",value:function(e){return this._map.get(e)}},{key:"getOne",value:function(e){var t,n=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=i(e))){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){u=!0,a=e},f:function(){try{s||null==n.return||n.return()}finally{if(u)throw a}}}}(this.get(e));try{for(n.s();!(t=n.n()).done;)return t.value}catch(e){n.e(e)}finally{n.f()}}},{key:"add",value:function(e,t){var n=this._map.get(e);return n||this._map.set(e,n=new Set),n.add(t)}},{key:"remove",value:function(e,t){var n=this._map.get(e);if(n){var r=n.delete(t);return n.size||this._map.delete(e),r}}},{key:"values",value:function(){return e(Set,r(r(this._map.values()).map(function(e){return r(e.values())})))}}])&&a(n.prototype,o),Object.defineProperty(n,"prototype",{writable:!1}),t}();t.SetMap=s}()}),require.register("curvature/base/Tag.js",function(t,n,r){n=e(n,{},"curvature"),function(){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Tag=void 0;var e=n("./Bindable");function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=Symbol("CurrentStyle"),o=function(e){if(this.node)for(var t in e){var n=String(e[t]);this[i].has(t)&&this[i].get(t)===e[t]||("-"===t[0]?this.node.style.setProperty(t,n):this.node.style[t]=n,void 0!==e[t]?this[i].set(t,e[t]):this[i].delete(t))}},a=function(e){var t=this;return"function"==typeof this[e]?this[e]:this.node&&"function"==typeof this.node[e]?function(){var n;return(n=t.node)[e].apply(n,arguments)}:"style"===e?this.proxy.style:this.node&&e in this.node?this.node[e]:this[e]},s=function(){function t(n,r,s,u,c){var l=this;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),"string"==typeof n){var f=document.createRange().createContextualFragment(n);n=f.firstChild}this.element=e.Bindable.makeBindable(n),this.node=this.element,this.parent=r,this.direct=c,this.ref=s,this.index=u,this.cleanup=[],this[e.Bindable.OnAllGet]=a.bind(this),this[i]=new Map;var d=e.Bindable.make(o.bind(this));return Object.defineProperty(this,"style",{value:d}),this.proxy=e.Bindable.make(this),this.proxy.style.bindTo(function(e,t,n,r){l[i].has(t)&&l[i].get(t)===e||(l.node.style[t]=e,r||void 0===e?l[i].delete(t):l[i].set(t,e))}),this.proxy.bindTo(function(e,t){if("index"!==t)return t in n&&n[t]!==e&&(n[t]=e),!1}),this.proxy}var n,s;return n=t,(s=[{key:"attr",value:function(e){for(var t in e)void 0===e[t]?this.node.removeAttribute(t):null===e[t]?this.node.setAttribute(t,""):this.node.setAttribute(t,e[t]);return this}},{key:"remove",value:function(){var t;for(this.node&&this.node.remove(),e.Bindable.clearBindings(this);t=this.cleanup.shift();)t();if(this.clear(),this.node){var n=new Event("cvDomDetached");this.node.dispatchEvent(n),this.node=this.element=this.ref=this.parent=void 0}}},{key:"clear",value:function(){if(this.node)for(var e=new Event("cvDomDetached");this.node.firstChild;)this.node.firstChild.dispatchEvent(e),this.node.removeChild(this.node.firstChild)}},{key:"pause",value:function(){}},{key:"listen",value:function(e,t,n){var r=this.node;r.addEventListener(e,t,n);var i=function(){r.removeEventListener(e,t,n)},o=function(){i(),i=function(){return console.warn("Already removed!")}};return this.parent.onRemove(function(){return o()}),o}}])&&r(n.prototype,s),Object.defineProperty(n,"prototype",{writable:!1}),t}();t.Tag=s}()}),require.register("curvature/base/Uuid.js",function(t,n,r){n=e(n,{},"curvature"),function(){"use strict";var e;function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Object.defineProperty(t,"__esModule",{value:!0}),t.Uuid=void 0,e=Symbol.toPrimitive;var i=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r(this,"uuid",null),r(this,"version",4),e){if(!e||"string"!=typeof e&&!(e instanceof t)||!e.match(/[0-9A-Fa-f]{8}(-[0-9A-Fa-f]{4}){3}-[0-9A-Fa-f]{12}/))throw new Error('Invalid input for Uuid: "'.concat(e,'"'));this.version=n,this.uuid=e}else"function"==typeof crypto.randomUUID?this.uuid=crypto.randomUUID():this.uuid=([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,function(e){return(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)});Object.freeze(this)}var i,o;return i=t,(o=[{key:e,value:function(){return this.toString()}},{key:"toString",value:function(){return this.uuid}},{key:"toJson",value:function(){return{version:this.version,uuid:this.uuid}}}])&&n(i.prototype,o),Object.defineProperty(i,"prototype",{writable:!1}),t}();t.Uuid=i}()}),require.register("curvature/base/View.js",function(t,n,r){n=e(n,{},"curvature"),function(){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.View=void 0;var e=n("./Bindable"),r=n("./ViewList"),i=n("./Router"),o=n("./Uuid"),a=n("./Dom"),s=n("./Tag"),u=n("./Bag"),c=n("./RuleSet"),l=n("./Mixin"),f=(n("../mixin/PromiseMixin"),n("../mixin/EventTargetMixin"));function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p(e){return function(e){if(Array.isArray(e))return b(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||y(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);a=!0);}catch(e){s=!0,i=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw i}}return o}}(e,t)||y(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=y(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function y(e,t){if(e){if("string"==typeof e)return b(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?b(e,t):void 0}}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function m(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function g(e,t){return(g=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function w(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=x(e);if(t){var i=x(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===d(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return O(e)}(this,n)}}function O(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function x(e){return(x=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var k=Symbol("dontParse"),j=Symbol("expandBind"),S=Symbol("uuid"),P=function(t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&g(e,t)}(x,t);var l,f,y,b=w(x);function x(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,x),t=b.call(this,n,r),Object.defineProperty(O(t),"args",{value:e.Bindable.make(n)}),Object.defineProperty(O(t),S,{value:t.constructor.uuid()}),Object.defineProperty(O(t),"nodesAttached",{value:new u.Bag(function(e,t,n){})}),Object.defineProperty(O(t),"nodesDetached",{value:new u.Bag(function(e,t,n){})}),Object.defineProperty(O(t),"_onRemove",{value:new u.Bag(function(e,t,n){})}),Object.defineProperty(O(t),"cleanup",{value:[]}),Object.defineProperty(O(t),"parent",{value:r}),Object.defineProperty(O(t),"views",{value:new Map}),Object.defineProperty(O(t),"viewLists",{value:new Map}),Object.defineProperty(O(t),"withViews",{value:new Map}),Object.defineProperty(O(t),"tags",{value:e.Bindable.make({})}),Object.defineProperty(O(t),"nodes",{value:e.Bindable.make([])}),Object.defineProperty(O(t),"timeouts",{value:new Map}),Object.defineProperty(O(t),"intervals",{value:[]}),Object.defineProperty(O(t),"frames",{value:[]}),Object.defineProperty(O(t),"ruleSet",{value:new c.RuleSet}),Object.defineProperty(O(t),"preRuleSet",{value:new c.RuleSet}),Object.defineProperty(O(t),"subBindings",{value:{}}),Object.defineProperty(O(t),"templates",{value:{}}),Object.defineProperty(O(t),"eventCleanup",{value:[]}),Object.defineProperty(O(t),"unpauseCallbacks",{value:new Map}),Object.defineProperty(O(t),"interpolateRegex",{value:/(\[\[((?:\$+)?[\w\.\|-]+)\]\])/g}),Object.defineProperty(O(t),"rendered",{value:new Promise(function(e,n){return Object.defineProperty(O(t),"renderComplete",{value:e})})}),t.controller=O(t),t.loaded=Promise.resolve(O(t)),t.template="",t.firstNode=null,t.lastNode=null,t.viewList=null,t.mainView=null,t.preserve=!1,t.removed=!1,t}return l=x,f=[{key:"_id",get:function(){return this[S]}},{key:"onFrame",value:function(e){var t=this,n=!1,r=function(){n=!0};return requestAnimationFrame(function(){return function r(i){t.removed||n||(t.paused||e(Date.now()),requestAnimationFrame(r))}(Date.now())}),this.frames.push(r),r}},{key:"onNextFrame",value:function(e){return requestAnimationFrame(function(){return e(Date.now())})}},{key:"onIdle",value:function(e){return requestIdleCallback(function(){return e(Date.now())})}},{key:"onTimeout",value:function(e,t){var n=this,r={timeout:null,callback:null,time:e,fired:!1,created:(new Date).getTime(),paused:!1},i=function(){t(),r.fired=!0,n.timeouts.delete(r.timeout)},o=setTimeout(i,e);return r.callback=i,r.timeout=o,this.timeouts.set(r.timeout,r),o}},{key:"clearTimeout",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){var t,n=h(this.timeouts);try{for(n.s();!(t=n.n()).done;){var r=v(t.value,2),i=(r[0],r[1]);clearTimeout(i.timeout),this.timeouts.delete(i.timeout)}}catch(e){n.e(e)}finally{n.f()}})},{key:"onInterval",value:function(e,t){var n=setInterval(t,e);return this.intervals.push({timeout:n,callback:t,time:e,paused:!1}),n}},{key:"clearInterval",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){for(var t in this.intervals)e===this.intervals[t].timeout&&(clearInterval(this.intervals[t].timeout),delete this.intervals[t])})},{key:"pause",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;if(void 0===e&&(this.paused=!this.paused),this.paused=e,this.paused){var t,n=h(this.timeouts);try{for(n.s();!(t=n.n()).done;){var r=v(t.value,2),i=(r[0],r[1]);i.fired?this.timeouts.delete(i.timeout):(clearTimeout(i.timeout),i.paused=!0,i.time=Math.max(0,i.time-(Date.now()-i.created)))}}catch(e){n.e(e)}finally{n.f()}for(var o in this.intervals)clearInterval(this.intervals[o].timeout)}else{var a,s=h(this.timeouts);try{for(s.s();!(a=s.n()).done;){var u=v(a.value,2),c=(u[0],u[1]);c.paused&&(c.fired?this.timeouts.delete(c.timeout):(c.timeout=setTimeout(c.callback,c.time),c.paused=!1))}}catch(e){s.e(e)}finally{s.f()}for(var l in this.intervals)this.intervals[l].timeout.paused&&(this.intervals[l].timeout.paused=!1,this.intervals[l].timeout=setInterval(this.intervals[l].callback,this.intervals[l].time));var f,d=h(this.unpauseCallbacks);try{for(d.s();!(f=d.n()).done;){(0,v(f.value,2)[1])()}}catch(e){d.e(e)}finally{d.f()}this.unpauseCallbacks.clear()}var p,y=h(this.viewLists);try{for(y.s();!(p=y.n()).done;){var b=v(p.value,2);(b[0],b[1]).pause(!!e)}}catch(e){y.e(e)}finally{y.f()}for(var m in this.tags)if(Array.isArray(this.tags[m]))for(var g in this.tags[m])this.tags[m][g].pause(!!e);else this.tags[m].pause(!!e)}},{key:"render",value:function(){var e,t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(n instanceof x&&(n=n.firstNode.parentNode),r instanceof x&&(r=r.firstNode),this.firstNode)return this.reRender(n,r);this.dispatchEvent(new CustomEvent("render"));var i=this.template instanceof DocumentFragment?this.template.cloneNode(!0):x.templates.has(this.template),o=i?this.template instanceof DocumentFragment?i:x.templates.get(this.template).cloneNode(!0):document.createRange().createContextualFragment(this.template);if(i||this.template instanceof DocumentFragment||x.templates.set(this.template,o.cloneNode(!0)),this.mainView||this.preRuleSet.apply(o,this),this.mapTags(o),this.mainView||this.ruleSet.apply(o,this),!0===window.devMode?(this.firstNode=document.createComment("Template ".concat(this._id," Start")),this.lastNode=document.createComment("Template ".concat(this._id," End"))):(this.firstNode=document.createTextNode(""),this.lastNode=document.createTextNode("")),(e=this.nodes).push.apply(e,[this.firstNode].concat(p(Array.from(o.childNodes)),[this.lastNode])),this.postRender(n),this.dispatchEvent(new CustomEvent("rendered")),this.dispatchAttach()){if(n){var a=n.getRootNode();if(r?(n.insertBefore(this.firstNode,r),n.insertBefore(this.lastNode,r)):(n.appendChild(this.firstNode),n.appendChild(this.lastNode)),n.insertBefore(o,this.lastNode),a.isConnected)this.attached(a,n),this.dispatchAttached(a,n);else{n.addEventListener("cvDomAttached",function e(r){r.target.isConnected&&(t.attached(a,n),t.dispatchAttached(a,n),n.removeEventListener("cvDomAttached",e))})}}return this.renderComplete(this.nodes),this.nodes}}},{key:"dispatchAttach",value:function(){return this.dispatchEvent(new CustomEvent("attach",{cancelable:!0,target:this}))}},{key:"dispatchAttached",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;this.dispatchEvent(new CustomEvent("attached",{detail:{view:n||this,node:t,root:e,mainView:this}})),this.dispatchDomAttached(n);var r,i=h(this.nodesAttached.items());try{for(i.s();!(r=i.n()).done;){(0,r.value)(e,t)}}catch(e){i.e(e)}finally{i.f()}}},{key:"dispatchDomAttached",value:function(e){var t=this;this.nodes.filter(function(e){return e.nodeType!==Node.COMMENT_NODE}).forEach(function(n){n.matches&&(a.Dom.mapTags(n,!1,function(n,r){n.matches&&n.dispatchEvent(new CustomEvent("cvDomAttached",{target:n,detail:{view:e||t,mainView:t}}))}),n.dispatchEvent(new CustomEvent("cvDomAttached",{target:n,detail:{view:e||t,mainView:t}})))})}},{key:"reRender",value:function(e,t){if(this.dispatchEvent(new CustomEvent("reRender"),{cancelable:!0,target:this})){var n=new DocumentFragment;if(this.firstNode.isConnected){var r=this.nodesDetached.items();for(var i in r)r[i]()}if(n.append.apply(n,p(this.nodes)),e){t?(e.insertBefore(this.firstNode,t),e.insertBefore(this.lastNode,t)):(e.appendChild(this.firstNode),e.appendChild(this.lastNode)),e.insertBefore(n,this.lastNode),this.dispatchEvent(new CustomEvent("reRendered"),{cancelable:!0,target:this});var o=e.getRootNode();o.isConnected&&(this.attached(o,e),this.dispatchAttached(o,e))}return this.nodes}}},{key:"mapTags",value:function(e){var t=this;a.Dom.mapTags(e,!1,function(e,n){e[k]||(e=e.matches?(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=t.mapInterpolatableTag(e)).matches("[cv-template]")&&t.mapTemplateTag(e)||e).matches("[cv-slot]")&&t.mapSlotTag(e)||e).matches("[cv-prerender]")&&t.mapPrendererTag(e)||e).matches("[cv-link]")&&t.mapLinkTag(e)||e).matches("[cv-attr]")&&t.mapAttrTag(e)||e).matches("[cv-expand]")&&t.mapExpandableTag(e)||e).matches("[cv-ref]")&&t.mapRefTag(e)||e).matches("[cv-on]")&&t.mapOnTag(e)||e).matches("[cv-each]")&&t.mapEachTag(e)||e).matches("[cv-bind]")&&t.mapBindTag(e)||e).matches("[cv-with]")&&t.mapWithTag(e)||e).matches("[cv-if]")&&t.mapIfTag(e)||e).matches("[cv-view]")&&t.mapViewTag(e)||e:t.mapInterpolatableTag(e))!==n.currentNode&&(n.currentNode=e)})}},{key:"mapExpandableTag",value:function(t){var n=t[j];n&&(n(),t[j]=!1);var r=v(e.Bindable.resolve(this.args,t.getAttribute("cv-expand"),!0),2),i=r[0],o=r[1];return t.removeAttribute("cv-expand"),i[o]||(i[o]={}),i[o]=e.Bindable.make(i[o]),this.onRemove(t[j]=i[o].bindTo(function(e,n,r,i,o){i||void 0===e?t.removeAttribute(n,e):null!==e?t.setAttribute(n,e):t.setAttribute(n,"")})),t}},{key:"compileExpandableTag",value:function(t){return function(n){var r=t.cloneNode(!0),i=r.getAttribute("cv-expand"),o=e.Bindable.make(n.args[i]||{});r.removeAttribute("cv-expand");var a=function(t){if("name"===t||"type"===t)return"continue";var i=o.bindTo(t,function(e,t){return function(n){e.setAttribute(t,n)}}(r,t));n.onRemove(function(){i(),o.isBound()&&e.Bindable.clearBindings(o)})};for(var s in o)a(s);return r}}},{key:"mapAttrTag",value:function(e){var t=this.compileAttrTag(e)(this);return e.replaceWith(t),t}},{key:"compileAttrTag",value:function(t){var n=t.getAttribute("cv-attr").split(",").map(function(e){return e.split(":")});return t.removeAttribute("cv-attr"),function(r){var i=t.cloneNode(!0),o=function(t){var o=n[t][1]||n[t][0],a=v(e.Bindable.resolve(r.args,o,!0),2),s=a[0],u=a[1],c=n[t][0];r.onRemove(s.bindTo(u,function(e,t,n,r){r||void 0===e?i.removeAttribute(c,e):null!==e?i.setAttribute(c,e):i.setAttribute(c,"")}))};for(var a in n)o(a);return i}}},{key:"mapInterpolatableTag",value:function(t){var n=this,r=this.interpolateRegex;if(t.nodeType===Node.TEXT_NODE){var i=t.nodeValue;if(!this.interpolatable(i))return t;for(var o,a=0,u=function(){var r=o[2],u=!1,c=!1,l=r.split("|"),f=!1;if(l.length>1&&(f=n.stringTransformer(l.slice(1)),r=l[0]),"$$"===r.substr(0,2)&&(u=!0,c=!0,r=r.substr(2)),"$"===r.substr(0,1)&&(u=!0,r=r.substr(1)),"000"===r.substr(0,3))return expand=!0,r=r.substr(3),"continue";var p=i.substring(a,o.index);a=o.index+o[1].length;var h=document.createTextNode(p);h[k]=!0,t.parentNode.insertBefore(h,t);var y=void 0;(y=u?document.createElement("div"):document.createTextNode(""))[k]=!0;var b=n.args,m=r;if(r.match(/\./)){var g=v(e.Bindable.resolve(n.args,r,!0),2);b=g[0],m=g[1]}if(t.parentNode.insertBefore(y,t),"object"!==d(b))return"break";var w=(b=e.Bindable.make(b)).bindTo(m,function(e,r,i){if(i[r]!==e&&(i[r]instanceof x||i[r]instanceof Node||i[r]instanceof s.Tag)&&(i[r].preserve||i[r].remove()),y.nodeValue="",c&&!(e instanceof x)){var o,a=null!==(o=e)&&void 0!==o?o:"";(e=new x(n.args,n)).template=a}if(f&&(e=f(e)),e instanceof x){var l=function(t,r){e.dispatchAttached(t,r,n)};n.nodesAttached.add(l),e.render(t.parentNode,y);var d=function(){e.preserve||e.remove()};n.onRemove(d),e.onRemove(function(){n.nodesAttached.remove(l),n._onRemove.remove(d)})}else e instanceof Node?(t.parentNode.insertBefore(e,y),n.onRemove(function(){return e.remove()})):e instanceof s.Tag?e.node?(t.parentNode.insertBefore(e.node,y),n.onRemove(function(){return e.remove()})):e.remove():(e instanceof Object&&e.__toString instanceof Function&&(e=e.__toString()),u?y.innerHTML=e:y.nodeValue=e);y[k]=!0});n.onRemove(w)};o=r.exec(i);){var c=u();if("continue"!==c&&"break"===c)break}var l=i.substring(a),f=document.createTextNode(l);f[k]=!0,t.parentNode.insertBefore(f,t),t.nodeValue=""}else if(t.nodeType===Node.ELEMENT_NODE)for(var p=function(i){if(!n.interpolatable(t.attributes[i].value))return"continue";for(var o=0,a=void 0,s=t.attributes[i].value,u=t.attributes[i],c={},l=[];a=r.exec(s);)l.push(s.substring(o,a.index)),c[a[2]]||(c[a[2]]=[]),c[a[2]].push(l.length),l.push(a[1]),o=a.index+a[1].length;l.push(s.substring(o));var f=function(r){var i=n.args,o=r,a=r.split("|"),s=!1,f=r;if(a.length>1&&(s=n.stringTransformer(a.slice(1)),o=a[0]),o.match(/\./)){var d=v(e.Bindable.resolve(n.args,o,!0),2);i=d[0],o=d[1]}c[f],n.onRemove(i.bindTo(o,function(e,r,i,a){for(var d in s&&(e=s(e)),c)for(var p in c[f])l[c[f][p]]=i[d],r===o&&(l[c[f][p]]=e);n.paused?n.unpauseCallbacks.set(u,function(){return t.setAttribute(u.name,l.join(""))}):t.setAttribute(u.name,l.join(""))})),n.onRemove(function(){i.isBound()||e.Bindable.clearBindings(i)})};for(var d in c)f(d)},h=0;h<t.attributes.length;h++)p(h);return t}},{key:"mapRefTag",value:function(e){var t=v(e.getAttribute("cv-ref").split(":"),3),n=t[0],r=t[1],i=void 0===r?null:r,o=t[2],a=void 0===o?null:o,u=s.Tag;i&&(u=this.stringToClass(i)),e.removeAttribute("cv-ref"),Object.defineProperty(e,"___tag___",{enumerable:!1,writable:!0}),this.onRemove(function(){e.___tag___=null,e.remove()});var c=this;this.viewList&&(c=this.viewList.parent);var l=new u(e,this,n,void 0,this);for(e.___tag___=l,this.tags[n]=l;c;){var f=this.args[a];if(void 0!==f?(c.tags[n]||(c.tags[n]=[]),c.tags[n][f]=l):c.tags[n]=l,!c.parent)break;c=c.parent}return e}},{key:"mapBindTag",value:function(t){var n=this,r=t.getAttribute("cv-bind"),i=this.args,o=r,u=null;if(r.match(/\./)){var c=v(e.Bindable.resolve(this.args,r,!0),3);i=c[0],o=c[1],u=c[2]}i!==this.args&&(this.subBindings[r]=this.subBindings[r]||[],this.onRemove(this.args.bindTo(u,function(){for(;n.subBindings.length;)n.subBindings.shift()()})));var l=!1;"$"===o.substr(0,1)&&(o=o.substr(1),l=!0);var f=i.bindTo(o,function(e,r,i,o,u){(u instanceof x||u instanceof Node||u instanceof s.Tag)&&u!==e&&u.remove();var c=new CustomEvent("cvAutoChanged",{bubbles:!0});if(["INPUT","SELECT","TEXTAREA"].includes(t.tagName)){var f=t.getAttribute("type");if(f&&"checkbox"===f.toLowerCase())t.checked=!!e,t.dispatchEvent(c);else if(f&&"radio"===f.toLowerCase())t.checked=e==t.value,t.dispatchEvent(c);else if("file"!==f){if("SELECT"===t.tagName){var d=function(){for(var n=0;n<t.options.length;n++)t.options[n].value==e&&(t.selectedIndex=n)};d(),n.nodesAttached.add(d)}else t.value=null==e?"":e;t.dispatchEvent(c)}}else if(e instanceof x){var p,v=h(t.childNodes);try{for(v.s();!(p=v.n()).done;)p.value.remove()}catch(e){v.e(e)}finally{v.f()}var y=function(t){e.dispatchDomAttached(n)};n.nodesAttached.add(y),e.render(t),e.onRemove(function(){return n.nodesAttached.remove(y)})}else if(e instanceof Node)t.insert(e);else if(e instanceof s.Tag)t.append(e.node);else if(l){if(t.innerHTML!==e){if(e=String(e),t.innerHTML===e.substring(0,t.innerHTML.length))t.innerHTML+=e.substring(t.innerHTML.length);else{var b,m=h(t.childNodes);try{for(m.s();!(b=m.n()).done;)b.value.remove()}catch(e){m.e(e)}finally{m.f()}t.innerHTML=e}a.Dom.mapTags(t,!1,function(e){return e[k]=!0})}}else if(t.textContent!==e){var g,w=h(t.childNodes);try{for(w.s();!(g=w.n()).done;)g.value.remove()}catch(e){w.e(e)}finally{w.f()}t.textContent=e}});i!==this.args&&this.subBindings[r].push(f),this.onRemove(f);var d=t.getAttribute("type"),p=t.getAttribute("multiple"),y=function(n){if(n.target===t)if(d&&"checkbox"===d.toLowerCase())t.checked?i[o]=n.target.getAttribute("value"):i[o]=!1;else if(n.target.matches("[contenteditable=true]"))i[o]=n.target.innerHTML;else if("file"===d&&p){var r=Array.from(n.target.files),a=i[o]||e.Bindable.onDeck(i,o);if(a&&r.length){var s=function(e){if(r[e]!==a[e])return r[e].toJSON=function(){return{name:file[e].name,size:file[e].size,type:file[e].type,date:file[e].lastModified}},a[e]=r[e],"break"};for(var u in r)if("break"===s(u))break}else i[o]=r}else if("file"===d&&!p&&n.target.files.length){var c=n.target.files.item(0);c.toJSON=function(){return{name:c.name,size:c.size,type:c.type,date:c.lastModified}},i[o]=c}else i[o]=n.target.value};return"file"===d||"radio"===d?t.addEventListener("change",y):(t.addEventListener("input",y),t.addEventListener("change",y),t.addEventListener("value-changed",y)),this.onRemove(function(){"file"===d||"radio"===d?t.removeEventListener("change",y):(t.removeEventListener("input",y),t.removeEventListener("change",y),t.removeEventListener("value-changed",y))}),t.removeAttribute("cv-bind"),t}},{key:"mapOnTag",value:function(e){var t=this;return String(e.getAttribute("cv-on")).split(";").map(function(e){return e.split(":")}).forEach(function(n){var r,i=(n=n.map(function(e){return e.trim()})).length,o=String(n.shift()).trim(),a=String(n.shift()||o).trim(),s=String(n.shift()||"").trim(),u=[],c=/(\w+)(?:\(([$\w\s-'",]+)\))?/.exec(a);c&&(a=c[1].replace(/(^[\s\n]+|[\s\n]+$)/,""),c[2]&&(u=c[2].split(",").map(function(e){return e.trim()}))),u.length||u.push("$event"),o&&1!==i||(o=a);for(var l=t,f=function(){var e=l.controller;return"function"==typeof e[a]?(r=function(){e[a].apply(e,arguments)},"break"):"function"==typeof l[a]?(r=function(){var e;(e=l)[a].apply(e,arguments)},"break"):l.parent?void(l=l.parent):"break"};l&&"break"!==f(););var d=function(n){var i=u.map(function(r){var i;return Number(r)==r?r:"event"===r||"$event"===r?n:"$view"===r?l:"$controller"===r?controller:"$tag"===r?e:"$parent"===r?t.parent:"$subview"===r?t:r in t.args?t.args[r]:(i=/^['"]([\w-]+?)["']$/.exec(r))?i[1]:void 0});if("function"!=typeof r)throw new Error("".concat(a," is not defined on View object.")+"\nTag:\n"+"".concat(e.outerHTML));r.apply(void 0,p(i))},v={};switch(s.includes("p")?v.passive=!0:s.includes("P")&&(v.passive=!1),s.includes("c")?v.capture=!0:s.includes("C")&&(v.capture=!1),s.includes("o")?v.once=!0:s.includes("O")&&(v.once=!1),o){case"_init":d();break;case"_attach":t.nodesAttached.add(d);break;case"_detach":t.nodesDetached.add(d);break;default:e.addEventListener(o,d,v),t.onRemove(function(){e.removeEventListener(o,d,v)})}return[o,a,u]}),e.removeAttribute("cv-on"),e}},{key:"mapLinkTag",value:function(e){var t=e.getAttribute("cv-link");e.setAttribute("href",t);var n=function(n){n.preventDefault(),"http"!==t.substring(0,4)&&"//"!==t.substring(0,2)?i.Router.go(e.getAttribute("href")):window.open(e.getAttribute("href",t))};return e.addEventListener("click",n),this.onRemove(function(e,t){return function(){e.removeEventListener("click",t),e=void 0,t=void 0}}(e,n)),e.removeAttribute("cv-link"),e}},{key:"compileLinkTag",value:function(e){var t=e.getAttribute("cv-link");return e.removeAttribute("cv-link"),function(n){var r=e.cloneNode(!0);return r.setAttribute("href",t),r}}},{key:"mapPrendererTag",value:function(e){var t=e.getAttribute("cv-prerender"),n=window.prerenderer||navigator.userAgent.match(/prerender/i);return n&&(window.prerenderer=window.prerenderer||!0),("never"===t&&n||"only"===t&&!n)&&e.parentNode.removeChild(e),e}},{key:"mapWithTag",value:function(t){var n=this,r=t.getAttribute("cv-with"),i=t.getAttribute("cv-carry"),o=t.getAttribute("cv-view");t.removeAttribute("cv-with"),t.removeAttribute("cv-carry"),t.removeAttribute("cv-view");var a=o?this.stringToClass(o):x,s=new DocumentFragment;p(t.childNodes).forEach(function(e){return s.appendChild(e)});var u=[];i&&(u=i.split(",").map(function(e){return e.trim()}));var c=this.args.bindTo(r,function(r,i,o,c){for(n.withViews.has(t)&&n.withViews.delete(t);t.firstChild;)t.removeChild(t.firstChild);var l=new a({},n);n.onRemove(function(e){return function(){e.remove()}}(l)),l.template=s;var f=function(e){var t=n.args.bindTo(u[e],function(e,t){l.args[t]=e});l.onRemove(t),n.onRemove(function(){t(),l.remove()})};for(var p in u)f(p);var v=function(t){if("object"!==d(r))return"continue";var i=(r=e.Bindable.make(r)).bindTo(t,function(e,t,n,r){r?t in l.args&&delete l.args[t]:l.args[t]=e});l.args.bindTo(t,function(e,t,n,i){i?t in r&&delete r[t]:r[t]=e}),n.onRemove(function(){i(),r.isBound()||e.Bindable.clearBindings(r),l.remove()}),l.onRemove(function(){i(),r.isBound()||e.Bindable.clearBindings(r)})};for(var h in r)v(h);l.render(t),n.withViews.set(t,l)});return this.onRemove(function(){n.withViews.delete(t),c()}),t}},{key:"mapViewTag",value:function(e){var t=this,n=e.getAttribute("cv-view");e.removeAttribute("cv-view");var r=new DocumentFragment;p(e.childNodes).forEach(function(e){return r.appendChild(e)});var i=n.split(":"),o=i.pop()?this.stringToClass(n):x,a=i.shift(),s=new o(this.args,this);return this.views.set(e,s),a&&this.views.set(a,s),this.onRemove(function(n){return function(){n.remove(),t.views.delete(e),t.views.delete(a)}}(s)),s.template=r,s.render(e),e}},{key:"mapEachTag",value:function(t){var n=this,i=t.getAttribute("cv-each"),o=t.getAttribute("cv-view");t.removeAttribute("cv-each"),t.removeAttribute("cv-view");var a=o?this.stringToClass(o):x,s=new DocumentFragment;p(t.childNodes).forEach(function(e){return s.appendChild(e)});var c=v(i.split(":"),3),l=c[0],f=c[1],d=c[2],h=this.args,y=l;if(l.match(/\./)){var b=v(e.Bindable.resolve(this.args,l,!0),2);h=b[0],y=b[1]}var m=h.bindTo(y,function(e,i,o,c,l){e instanceof u.Bag&&(e=e.list),n.viewLists.has(t)&&n.viewLists.get(t).remove();var p=new r.ViewList(s,f,e,n,d,a),v=function(){return p.remove()};n.onRemove(v),p.onRemove(function(){return n._onRemove.remove(v)});var h=n.args.bindTo(function(e,t,n,r){"_id"!==t&&(r?t in p.subArgs&&delete p.subArgs[t]:p.subArgs[t]=e)}),y=p.args.bindTo(function(e,t,r,i,o){"_id"!==t&&"value"!==t&&"___"!==String(t).substring(0,3)&&(i?delete n.args[t]:t in n.args&&(n.args[t]=e))});for(p.onRemove(h),p.onRemove(y),n.onRemove(h),n.onRemove(y);t.firstChild;)t.removeChild(t.firstChild);n.viewLists.set(t,p),p.render(t)});return this.onRemove(m),t}},{key:"mapIfTag",value:function(t){var n=this,r=t,i=r.getAttribute("cv-view"),o=r.getAttribute("cv-if"),s=r.getAttribute("cv-is"),c=!1,l=!1;r.removeAttribute("cv-view"),r.removeAttribute("cv-if"),r.removeAttribute("cv-is");var f=i?this.stringToClass(i):x;"!"===o.substr(0,1)&&(o=o.substr(1),c=!0),"?"===o.substr(0,1)&&(o=o.substr(1),l=!0);var d=new DocumentFragment;p(r.childNodes).forEach(function(e){return d.appendChild(e)});var h=this,y=new DocumentFragment,b=new f(Object.assign({},this.args),h);b.tags.bindTo(function(e,t){return n.tags[t]=e},{removeWith:this}),b.template=d;var m=h.args,g=o;if(o.match(/\./)){var w=v(e.Bindable.resolve(h.args,o,!0),2);m=w[0],g=w[1]}b.render(y);var O=m.bindTo(g,function(e,r){var i=e;l&&(e=null!=e),e instanceof u.Bag&&(e=e.list),Array.isArray(e)&&(e=!!e.length),null!==s&&(e=i==s),c&&(e=!e),e?(t.appendChild(y),p(y.childNodes).forEach(function(e){return a.Dom.mapTags(e,!1,function(e,t){e.matches&&e.dispatchEvent(new CustomEvent("cvDomAttached",{target:e,detail:{view:b||n,mainView:n}}))})})):(b.nodes.forEach(function(e){return y.appendChild(e)}),a.Dom.mapTags(y,!1,function(e,t){e.matches&&new CustomEvent("cvDomDetached",{target:e,detail:{view:b||n,mainView:n}})}))},{children:Array.isArray(m[g])});h.onRemove(O);var k=this.args.bindTo(function(e,t,n,r){"_id"!==t&&(r?t in b.args&&delete b.args[t]:b.args[t]=e)}),j=b.args.bindTo(function(e,t,r,i,o){"_id"!==t&&"___"!==String(t).substring(0,3)&&t in n.args&&(i?delete n.args[t]:n.args[t]=e)});return h.onRemove(function(){O(),k(),j(),h._onRemove.remove(O)}),this.onRemove(function(){k(),j(),b.remove(),h!==n&&h.remove()}),t}},{key:"compileIfTag",value:function(t){var n=t.getAttribute("cv-if"),r=!1;t.removeAttribute("cv-if"),"!"===n.substr(0,1)&&(n=n.substr(1),r=!0);var i=new DocumentFragment;return p(t.childNodes).forEach(function(e){return i.appendChild(e.cloneNode(!0))}),function(o){var a=t.cloneNode(),s=new DocumentFragment,u=new x({},o);u.template=i,o.syncBind(u);var c=o.args,l=n;if(n.match(/\./)){var f=v(e.Bindable.resolve(o.args,n,!0),2);c=f[0],l=f[1]}var d=!1,p=c.bindTo(l,function(e,t){if(!d){var n=o.args[l]||r?a:s;return u.render(n),void(d=!0)}Array.isArray(e)&&(e=!!e.length),r&&(e=!e),e?a.appendChild(s):u.nodes.forEach(function(e){return s.appendChild(e)})});o.onRemove(p);var h=function(){c.isBound()||e.Bindable.clearBindings(c)};return u.onRemove(function(){p(),h(),o._onRemove.remove(p),o._onRemove.remove(h)}),a}}},{key:"mapTemplateTag",value:function(e){var t=e.getAttribute("cv-template");return e.removeAttribute("cv-template"),this.templates[t]=function(){return"TEMPLATE"===e.tagName?e.content.cloneNode(!0):new DocumentFragment(e.innerHTML)},this.rendered.then(function(){return e.remove()}),e}},{key:"mapSlotTag",value:function(e){var t=e.getAttribute("cv-slot"),n=this.templates[t];if(!n){for(var r=this;r&&!(n=r.templates[t]);)r=this.parent;if(!n)return void console.error("Template ".concat(t," not found."))}var i=n();for(e.removeAttribute("cv-slot");e.firstChild;)e.firstChild.remove();return e.appendChild(i),e}},{key:"syncBind",value:function(e){var t=this,n=this.args.bindTo(function(t,n,r,i){"_id"!==n&&e.args[n]!==t&&(e.args[n]=t)}),r=e.args.bindTo(function(e,n,r,i,o){if("_id"!==n){var a=e,s=o;a instanceof x&&(a=a.___ref___),s instanceof x&&(s=s.___ref___),a!==s&&s instanceof x&&o.remove(),n in t.args&&(t.args[n]=e)}});this.onRemove(n),this.onRemove(r),e.onRemove(function(){t._onRemove.remove(n),t._onRemove.remove(r)})}},{key:"postRender",value:function(e){}},{key:"attached",value:function(e){}},{key:"interpolatable",value:function(e){return!!String(e).match(this.interpolateRegex)}},{key:"remove",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.dispatchEvent(new CustomEvent("remove",{detail:{view:this},cancelable:!0}))){var n=function(){for(var t in e.tags)Array.isArray(e.tags[t])?(e.tags[t]&&e.tags[t].forEach(function(e){return e.remove()}),e.tags[t].splice(0)):(e.tags[t]&&e.tags[t].remove(),e.tags[t]=void 0);for(var n in e.nodes)e.nodes[n]&&e.nodes[n].dispatchEvent(new Event("cvDomDetached")),e.nodes[n]&&e.nodes[n].remove(),e.nodes[n]=void 0;e.nodes.splice(0),e.firstNode=e.lastNode=void 0};t?n():requestAnimationFrame(n);var r,i=h(this._onRemove.items());try{for(i.s();!(r=i.n()).done;){var o=r.value;o(),this._onRemove.remove(o)}}catch(e){i.e(e)}finally{i.f()}var a,s=h(this.cleanup);try{for(s.s();!(a=s.n()).done;){var u=a.value;u&&u()}}catch(e){s.e(e)}finally{s.f()}this.cleanup.length=0;var c,l=h(this.viewLists);try{for(l.s();!(c=l.n()).done;){var f=v(c.value,2);(f[0],f[1]).remove()}}catch(e){l.e(e)}finally{l.f()}this.viewLists.clear();var d,p=h(this.timeouts);try{for(p.s();!(d=p.n()).done;){var y=v(d.value,2),b=(y[0],y[1]);clearTimeout(b.timeout),this.timeouts.delete(b.timeout)}}catch(e){p.e(e)}finally{p.f()}var m,g=h(this.intervals);try{for(g.s();!(m=g.n()).done;){var w=m.value;clearInterval(w)}}catch(e){g.e(e)}finally{g.f()}this.intervals.length=0;var O,x=h(this.frames);try{for(x.s();!(O=x.n()).done;){(0,O.value)()}}catch(e){x.e(e)}finally{x.f()}this.frames.length=0,this.preRuleSet.purge(),this.ruleSet.purge(),this.removed=!0,this.dispatchEvent(new CustomEvent("removed",{detail:{view:this},cancelable:!0}))}}},{key:"findTag",value:function(e){for(var t in this.nodes){var n;if(this.nodes[t].querySelector){if(this.nodes[t].matches(e))return new s.Tag(this.nodes[t],this,void 0,void 0,this);if(n=this.nodes[t].querySelector(e))return new s.Tag(n,this,void 0,void 0,this)}}}},{key:"findTags",value:function(e){var t=this;return this.nodes.filter(function(e){return e.querySelectorAll}).map(function(t){return p(t.querySelectorAll(e))}).flat().map(function(e){return new s.Tag(e,t,void 0,void 0,t)})||[]}},{key:"onRemove",value:function(e){e instanceof Event||this._onRemove.add(e)}},{key:"update",value:function(){}},{key:"beforeUpdate",value:function(e){}},{key:"afterUpdate",value:function(e){}},{key:"stringTransformer",value:function(e){var t=this;return function(n){for(var r in e){for(var i=t,o=e[r];i&&!i[o];)i=i.parent;if(!i)return;n=i[e[r]](n)}return n}}},{key:"stringToClass",value:function(e){if(x.refClasses.has(e))return x.refClasses.get(e);var t=e.split("/"),r=t[t.length-1],i=n(e);return x.refClasses.set(e,i[r]),i[r]}},{key:"preventParsing",value:function(e){e[k]=!0}},{key:"toString",value:function(){return this.nodes.map(function(e){return e.outerHTML}).join(" ")}},{key:"listen",value:function(e,t,n,r){var i=this;if("string"==typeof e&&(r=n,n=t,t=e,e=this),e instanceof x)return this.listen(e.nodes,t,n,r);if(Array.isArray(e))return e.map(function(e){return i.listen(e,t,n,r)}).forEach(function(e){return e()});if(e instanceof s.Tag)return this.listen(e.element,t,n,r);e.addEventListener(t,n,r);var o=function(){return e.removeEventListener(t,n,r)},a=function(){o(),o=function(){}};return this.onRemove(function(){return a()}),a}},{key:"detach",value:function(){for(var e in this.nodes)this.nodes[e].remove();return this.nodes}}],y=[{key:"from",value:function(e){var t=new this(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},arguments.length>2&&void 0!==arguments[2]?arguments[2]:null);return t.template=e,t}},{key:"isView",value:function(){return x}},{key:"uuid",value:function(){return new o.Uuid}}],f&&m(l.prototype,f),y&&m(l,y),Object.defineProperty(l,"prototype",{writable:!1}),x}(l.Mixin.with(f.EventTargetMixin));t.View=P,Object.defineProperty(P,"templates",{value:new Map}),Object.defineProperty(P,"refClasses",{value:new Map})}()}),require.register("curvature/base/ViewList.js",function(t,n,r){n=e(n,{},"curvature"),function(){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ViewList=void 0;var e=n("./Bindable"),r=n("./SetMap"),i=n("./Bag");function o(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){u=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(u)throw o}}}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var c=function(){function t(n,r,o,a){var u=this,c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,t),this.removed=!1,this.args=e.Bindable.makeBindable({}),this.args.value=e.Bindable.makeBindable(o||{}),this.subArgs=e.Bindable.makeBindable({}),this.views=[],this.cleanup=[],this.viewClass=l,this._onRemove=new i.Bag,this.template=n,this.subProperty=r,this.keyProperty=c,this.tag=null,this.downDebind=[],this.upDebind=[],this.paused=!1,this.parent=a,this.rendered=new Promise(function(e,t){Object.defineProperty(u,"renderComplete",{configurable:!1,writable:!0,value:e})}),this.willReRender=!1,this.args.___before(function(e,t,n,r,i){"bindTo"!=t&&(u.paused=!0)}),this.args.___after(function(e,t,n,r,i){"bindTo"!=t&&(u.paused=n.length>1,u.reRender())});var f=this.args.value.bindTo(function(e,t,n,r){if(!u.paused){var i=t;if("symbol"!==s(t))if(isNaN(t)&&(i="_"+t),r)for(var o in u.views[i]&&u.views[i].remove(),delete u.views[i],u.views)isNaN(o)?u.views[o].args[u.keyProperty]=o.substr(1):u.views[o].args[u.keyProperty]=o;else u.views[i]?u.views[i]&&u.views[i].args&&(u.views[i].args[u.keyProperty]=t,u.views[i].args[u.subProperty]=e):(cancelAnimationFrame(u.willReRender),u.willReRender=requestAnimationFrame(function(){u.reRender()}))}});this._onRemove.add(f),Object.preventExtensions(this)}var n,a;return n=t,(a=[{key:"render",value:function(e){var t,n=this,r=[],i=o(this.views);try{var a=function(){var n=t.value;n.render(e),r.push(n.rendered.then(function(){return n}))};for(i.s();!(t=i.n()).done;)a()}catch(e){i.e(e)}finally{i.f()}this.tag=e,Promise.all(r).then(function(e){return n.renderComplete(e)}),this.parent.dispatchEvent(new CustomEvent("listRendered",{detail:{detail:{key:this.subProperty,value:this.args.value}}}))}},{key:"reRender",value:function(){var e=this;if(!this.paused&&this.tag){var t=[],n=new r.SetMap;for(var i in this.views){var a=this.views[i],s=a.args[this.subProperty];n.add(s,a),t[i]=a}var u=[],c=new Set;this.downDebind.length&&this.downDebind.forEach(function(e){return e&&e()}),this.upDebind.length&&this.upDebind.forEach(function(e){return e&&e()}),this.upDebind.length=0,this.downDebind.length=0;var l=1/0,f=1/0,d=function(t){var r=!1,i=t;if(isNaN(i)?i="_"+t:String(i).length&&(i=Number(i)),void 0!==e.args.value[t]&&n.has(e.args.value[t])){var o=n.getOne(e.args.value[t]);o&&(o.args[e.keyProperty]=t,u[i]=o,c.add(o),r=!0,isNaN(i)||(l=Math.min(l,i),i>0&&(f=Math.min(f,i))),n.remove(e.args.value[t],o))}if(!r){var a={},s=u[i]=new e.viewClass(a,e.parent);isNaN(i)||(l=Math.min(l,i),i>0&&(f=Math.min(f,i))),u[i].template=e.template,u[i].viewList=e,u[i].args[e.keyProperty]=t,u[i].args[e.subProperty]=e.args.value[t],e.upDebind[i]=a.bindTo(e.subProperty,function(t,n,r,i){var o=a[e.keyProperty];i?delete e.args.value[o]:e.args.value[o]=t}),e.downDebind[i]=e.subArgs.bindTo(function(e,t,n,r){r?delete a[t]:a[t]=e});var d=function(){e.upDebind.filter(function(e){return e}).forEach(function(e){return e()}),e.upDebind.length=0},p=function(){e.downDebind.filter(function(e){return e}).forEach(function(e){return e()}),e.downDebind.length=0};s.onRemove(function(){e._onRemove.remove(d),e._onRemove.remove(p),e.upDebind[i]&&e.upDebind[i](),e.downDebind[i]&&e.downDebind[i](),delete e.upDebind[i],delete e.downDebind[i]}),e._onRemove.add(d),e._onRemove.add(p),a[e.subProperty]=e.args.value[t]}};for(var p in this.args.value)d(p);for(var v in t)c.has(t[v])||t[v].remove();if(Array.isArray(this.args.value)){var h=0===l&&void 0!==u[1]&&u.length>1||f===1/0?l:f;this.rendered=function t(){for(var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=u.length-n-1;r>h&&void 0===u[r];)r--;if(r<h)return Promise.resolve();if(u[r]===e.views[r]){if(u[r]&&!u[r].firstNode)return u[r].render(e.tag,u[r+1]),u[r].rendered.then(function(){return t(Number(n)+1)});return 0===n||n%500?t(Number(n)+1):new Promise(function(e){return requestAnimationFrame(function(){return e(t(Number(n)+1))})})}return u[r].render(e.tag,u[r+1]),e.views.splice(r,0,u[r]),u[r].rendered.then(function(){return t(n+1)})}()}else{var y,b=[],m=Object.assign({},u),g=function(e){return parseInt(e)===e-0},w=o(Object.keys(u).sort(function(e,t){return g(e)&&g(t)?Math.sign(e-t):g(e)||g(t)?!g(e)&&g(t)?-1:g(e)&&!g(t)?1:void 0:0}));try{var O=function(){var t=y.value;if(delete m[t],u[t].firstNode&&u[t]===e.views[t])return"continue";u[t].render(e.tag),b.push(u[t].rendered.then(function(){return u[t]}))};for(w.s();!(y=w.n()).done;)O()}catch(e){w.e(e)}finally{w.f()}for(var x in m)delete this.args.views[x],m.remove();this.rendered=Promise.all(b)}for(var k in u)isNaN(k)?u[k].args[this.keyProperty]=k.substr(1):u[k].args[this.keyProperty]=k;this.views=Array.isArray(this.args.value)?[].concat(u):u,c.clear(),this.willReRender=!1,this.rendered.then(function(){e.parent.dispatchEvent(new CustomEvent("listRendered",{detail:{detail:{key:e.subProperty,value:e.args.value,tag:e.tag}}})),e.tag.dispatchEvent(new CustomEvent("listRendered",{detail:{detail:{key:e.subProperty,value:e.args.value,tag:e.tag}}}))})}}},{key:"pause",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];for(var t in this.views)this.views[t].pause(e)}},{key:"onRemove",value:function(e){this._onRemove.add(e)}},{key:"remove",value:function(){for(var t in this.views)this.views[t].remove();var n=this._onRemove.items();for(var r in n)this._onRemove.remove(n[r]),n[r]();for(;this.cleanup.length;)this.cleanup.pop()();for(this.views=[];this.tag&&this.tag.firstChild;)this.tag.removeChild(this.tag.firstChild);this.subArgs&&e.Bindable.clearBindings(this.subArgs),e.Bindable.clearBindings(this.args),this.args.value&&!this.args.value.isBound()&&e.Bindable.clearBindings(this.args.value),this.removed=!0}}])&&u(n.prototype,a),Object.defineProperty(n,"prototype",{writable:!1}),t}();t.ViewList=c}()}),require.register("curvature/input/Axis.js",function(t,n,r){n=e(n,{},"curvature"),function(){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Axis=void 0;var e,r=n("../base/Bindable");function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}e=r.Bindable.NoGetters;var a=function(){function t(n){var r=n.deadZone,i=void 0===r?0:r,a=n.proportional,s=void 0===a||a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o(this,e,!0),o(this,"magnitude",0),o(this,"delta",0),this.proportional=s,this.deadZone=i}var n,r;return n=t,(r=[{key:"tilt",value:function(e){this.deadZone&&Math.abs(e)>=this.deadZone?e=(Math.abs(e)-this.deadZone)/(1-this.deadZone)*Math.sign(e):this.deadZone&&Math.abs(e)<this.deadZone&&(e=0),this.delta=Number(e-this.magnitude).toFixed(3)-0,this.magnitude=Number(e).toFixed(3)-0}},{key:"zero",value:function(){this.magnitude=this.delta=0}}])&&i(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),t}();t.Axis=a}()}),require.register("curvature/input/Button.js",function(t,n,r){n=e(n,{},"curvature"),function(){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Button=void 0;var e,r=n("../base/Bindable");function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}e=r.Bindable.NoGetters;var a=function(){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o(this,e,!0),o(this,"active",!1),o(this,"pressure",0),o(this,"delta",0),o(this,"time",0)}var n,r;return n=t,(r=[{key:"update",value:function(){this.pressure?this.time++:!this.pressure&&this.time>0?this.time=-1:!this.pressure&&this.time<0&&this.time--,this.time<-1&&-1===this.delta&&(this.delta=0)}},{key:"press",value:function(e){this.delta=Number(e-this.pressure).toFixed(3)-0,this.pressure=Number(e).toFixed(3)-0,this.active=!0,this.time=this.time>0?this.time:0}},{key:"release",value:function(){this.active&&(this.delta=Number(-this.pressure).toFixed(3)-0,this.pressure=0,this.active=!1)}},{key:"zero",value:function(){this.pressure=this.delta=0,this.active=!1}}])&&i(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),t}();t.Button=a}()}),require.register("curvature/input/Gamepad.js",function(t,n,r){n=e(n,{},"curvature"),function(){"use strict";function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Gamepad=void 0;var r,i=n("../base/Bindable"),o=n("../base/Mixin"),a=n("../mixin/EventTargetMixin"),s=n("./Axis"),u=n("./Button");function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(t,n){if(n&&("object"===e(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return d(t)}function d(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function h(e){return function(e){if(Array.isArray(e))return y(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return y(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?y(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var b={Space:0,Enter:0,NumpadEnter:0,ControlLeft:1,ControlRight:1,ShiftLeft:2,ShiftRight:2,KeyZ:3,KeyQ:4,KeyE:5,Digit1:6,Digit3:7,KeyW:12,KeyA:14,KeyS:13,KeyD:15,KeyH:112,KeyJ:113,KeyK:114,KeyL:115,KeyP:9,Pause:9,Tab:11,ArrowUp:12,ArrowDown:13,ArrowLeft:14,ArrowRight:15,Numpad4:112,Numpad2:113,Numpad8:114,Numpad6:115,Backquote:1010,NumpadAdd:1011,NumpadSubtract:1012,NumpadMultiply:1013,NumpadDivide:1014,Escape:1020};h(Array(12)).map(function(e,t){return b["F".concat(t)]=2e3+t}),r=i.Bindable.NoGetters;var m=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&l(e,t)}(a,e);var t,n,i,o=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=p(e);if(t){var i=p(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f(this,n)}}(a);function a(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(t.keys,t.deadZone),i=void 0===n?0:n,s=t.gamepad,u=void 0===s?null:s,c=(t.keyboard,t.axisMap),l=void 0===c?null:c;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),v(d(e=o.call(this)),r,!0),v(d(e),"axisMap",{12:-1,13:1,14:-0,15:0,112:-2,113:3,114:-3,115:2}),e.deadZone=i,e.gamepad=u,e.index=u.index,e.id=u.id,e.axisMap=l||e.axisMap,Object.defineProperties(d(e),{buttons:{value:{}},pressure:{value:{}},axes:{value:{}},keys:{value:{}}}),e}return t=a,n=[{key:"update",value:function(){for(var e in this.buttons)this.buttons[e].update()}},{key:"rumbleEffect",value:function(e){return this.gamepad.vibrationActuator.playEffect("dual-rumble",e)}},{key:"rumble",value:function(){var e;if(this.gamepad.vibrationActuator.pulse)return(e=this.gamepad.vibrationActuator).pulse.apply(e,arguments);this.rumbleEffect({duration:1e3,strongMagnitude:1,weakMagnitude:1})}},{key:"readInput",value:function(){if(this.gamepad){var e=String(this.gamepad.index),t=this.constructor;t.padsRead.has(e)||(t.padsRead=new Map(Object.entries(navigator.getGamepads())));var n=this.gamepad=t.padsRead.get(e);t.padsRead.delete(e);var r={},i={};if(n)for(var o in n.buttons){var a=n.buttons[o];a.pressed&&(this.press(o,a.value),r[o]=!0)}if(this.keyboard){for(var s in h(Array(10)))r[s]||this.keyboard.getKeyCode(s)>0&&(this.press(s,1),r[s]=!0);for(var c in b)if(!r[c]){var l=b[c];this.keyboard.getKeyCode(c)>0&&(this.press(l,1),r[l]=!0)}}if(n)for(var f in n.buttons)r[f]||n.buttons[f].pressed||(this.release(f),i[f]=!0);if(this.keyboard){for(var d in h(Array(10)))i[d]||r[d]||this.keyboard.getKeyCode(d)<0&&(this.release(d),i[d]=!0);for(var p in b){var v=b[p];i[v]||r[v]||this.keyboard.getKeyCode(p)<0&&(this.release(v),i[p]=!0)}}var y={};if(n)for(var m in n.axes){var g=n.axes[m];y[m]=!0,this.tilt(m,g)}for(var w in this.axisMap){this.buttons[w]||(this.buttons[w]=new u.Button);var O=this.axisMap[w],x=Math.sign(1/O),k=Math.abs(O);this.buttons[w].active?(y[k]=!0,this.tilt(k,x)):y[k]||this.tilt(k,0)}}}},{key:"tilt",value:function(e,t){this.axes[e]||(this.axes[e]=new s.Axis({deadZone:this.deadZone})),this.axes[e].tilt(t)}},{key:"press",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.buttons[e]||(this.buttons[e]=new u.Button),this.buttons[e].press(t)}},{key:"release",value:function(e){this.buttons[e]||(this.buttons[e]=new u.Button),this.buttons[e].release()}},{key:"serialize",value:function(){var e={};for(var t in this.buttons)e[t]=this.buttons[t].pressure;var n={};for(var r in this.axes)n[r]=this.axes[r].magnitude;return{axes:n,buttons:e}}},{key:"replay",value:function(e){if(e.buttons)for(var t in e.buttons)e.buttons[t]>0?this.press(t,e.buttons[t]):this.release(t);if(e.axes)for(var n in e.axes)e.axes[n].magnitude!==e.axes[n]&&this.tilt(n,e.axes[n])}},{key:"zero",value:function(){for(var e in this.axes)this.axes[e].zero();for(var t in this.buttons)this.buttons[t].zero()}}],i=[{key:"getPad",value:function(e){var t=this,n=e.index,r=void 0===n?void 0:n,i=e.deadZone,o=void 0===i?0:i,a=e.keys,s=void 0===a?{}:a,u=e.keyboard,c=void 0===u?null:u,l=e.axisMap,f=void 0===l?null:l;if(this.padsConnected.has(r))return this.padsConnected.get(r);var d=new Promise(function(e){addEventListener("gamepadconnected",function(n){n.stopImmediatePropagation();var r=new t({gamepad:n.gamepad,deadZone:o,keys:s,keyboard:c,axisMap:f});t.padsConnected.set(n.gamepad.index,d),e(r)},{once:!0})});return d}}],n&&c(t.prototype,n),i&&c(t,i),Object.defineProperty(t,"prototype",{writable:!1}),a}(o.Mixin.with(a.EventTargetMixin));t.Gamepad=m,v(m,"padsConnected",new Map),v(m,"padsRead",new Map)}()}),require.register("curvature/input/Keyboard.js",function(t,n,r){n=e(n,{},"curvature"),function(){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Keyboard=void 0;var e=n("../base/Bindable");function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=function(){function t(){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.maxDecay=120,this.comboTime=500,this.listening=!1,this.focusElement=document.body,this[e.Bindable.NoGetters]=!0,Object.defineProperty(this,"combo",{value:e.Bindable.make([])}),Object.defineProperty(this,"whichs",{value:e.Bindable.make({})}),Object.defineProperty(this,"codes",{value:e.Bindable.make({})}),Object.defineProperty(this,"keys",{value:e.Bindable.make({})}),Object.defineProperty(this,"pressedWhich",{value:e.Bindable.make({})}),Object.defineProperty(this,"pressedCode",{value:e.Bindable.make({})}),Object.defineProperty(this,"pressedKey",{value:e.Bindable.make({})}),Object.defineProperty(this,"releasedWhich",{value:e.Bindable.make({})}),Object.defineProperty(this,"releasedCode",{value:e.Bindable.make({})}),Object.defineProperty(this,"releasedKey",{value:e.Bindable.make({})}),Object.defineProperty(this,"keyRefs",{value:e.Bindable.make({})}),document.addEventListener("keyup",function(e){n.listening&&(n.keys[e.key]>0||!n.focusElement||document.activeElement===n.focusElement||n.focusElement.contains(document.activeElement)&&!document.activeElement.matches("input,textarea"))&&(e.preventDefault(),n.releasedWhich[e.which]=Date.now(),n.releasedCode[e.code]=Date.now(),n.releasedKey[e.key]=Date.now(),n.whichs[e.which]=-1,n.codes[e.code]=-1,n.keys[e.key]=-1)}),document.addEventListener("keydown",function(e){n.listening&&(!n.focusElement||document.activeElement===n.focusElement||n.focusElement.contains(document.activeElement)&&!document.activeElement.matches("input,textarea"))&&(e.preventDefault(),e.repeat||(n.combo.push(e.code),clearTimeout(n.comboTimer),n.comboTimer=setTimeout(function(){return n.combo.splice(0)},n.comboTime),n.pressedWhich[e.which]=Date.now(),n.pressedCode[e.code]=Date.now(),n.pressedKey[e.key]=Date.now(),n.keys[e.key]>0||(n.whichs[e.which]=1,n.codes[e.code]=1,n.keys[e.key]=1)))});var r=function(e){for(var t in n.keys)n.keys[t]<0||(n.releasedKey[t]=Date.now(),n.keys[t]=-1);for(var r in n.codes)n.codes[r]<0||(n.releasedCode[r]=Date.now(),n.codes[r]=-1);for(var i in n.whichs)n.whichs[i]<0||(n.releasedWhich[i]=Date.now(),n.whichs[i]=-1)};window.addEventListener("blur",r),window.addEventListener("visibilitychange",function(){"visible"!==document.visibilityState&&r()})}var n,i,o;return n=t,o=[{key:"get",value:function(){return this.instance=this.instance||e.Bindable.make(new this)}}],(i=[{key:"getKeyRef",value:function(t){return this.keyRefs[t]=this.keyRefs[t]||e.Bindable.make({})}},{key:"getKeyTime",value:function(e){var t=this.releasedKey[e],n=this.pressedKey[e];return n?!t||t<n?Date.now()-n:-1*(Date.now()-t):0}},{key:"getCodeTime",value:function(e){var t=this.releasedCode[e],n=this.pressedCode[e];return n?!t||t<n?Date.now()-n:-1*(Date.now()-t):0}},{key:"getWhichTime",value:function(e){var t=this.releasedWhich[e],n=this.pressedWhich[e];return n?!t||t<n?Date.now()-n:-1*(Date.now()-t):0}},{key:"getKey",value:function(e){return this.keys[e]?this.keys[e]:0}},{key:"getKeyCode",value:function(e){return this.codes[e]?this.codes[e]:0}},{key:"reset",value:function(){for(var e in this.keys)delete this.keys[e];for(var e in this.codes)delete this.codes[e];for(var e in this.whichs)delete this.whichs[e]}},{key:"update",value:function(){for(var e in this.keys)this.keys[e]>0?this.keys[e]++:this.keys[e]>-this.maxDecay?this.keys[e]--:delete this.keys[e];for(var e in this.codes){var t=this.releasedCode[e],n=this.pressedCode[e],r=this.getKeyRef(e);if(this.codes[e]>0){if(r.frames=this.codes[e]++,r.time=n?Date.now()-n:0,r.down=!0,!t||t<n)return;return-1*(Date.now()-t)}this.codes[e]>-this.maxDecay?(r.frames=this.codes[e]--,r.time=t-Date.now(),r.down=!1):(r.frames=0,r.time=0,r.down=!1,delete this.codes[e])}for(var e in this.whichs)this.whichs[e]>0?this.whichs[e]++:this.whichs[e]>-this.maxDecay?this.whichs[e]--:delete this.whichs[e]}}])&&r(n.prototype,i),o&&r(n,o),Object.defineProperty(n,"prototype",{writable:!1}),t}();t.Keyboard=i}()}),require.register("curvature/mixin/EventTargetMixin.js",function(t,n,r){n=e(n,{},"curvature"),function(){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EventTargetMixin=void 0;var e,r=n("../base/Mixin");function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var o=Symbol("Target"),a=(i(e={},r.Mixin.Constructor,function(){try{this[o]=new EventTarget}catch(e){this[o]=document.createDocumentFragment()}}),i(e,"dispatchEvent",function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=n[0];"string"==typeof i&&(i=new CustomEvent(i),n[0]=i),(e=this[o]).dispatchEvent.apply(e,n);var a="on".concat(i.type[0].toUpperCase()+i.type.slice(1));return"function"==typeof this[a]&&this[a](i),i.returnValue}),i(e,"addEventListener",function(){var e;(e=this[o]).addEventListener.apply(e,arguments)}),i(e,"removeEventListener",function(){var e;(e=this[o]).removeEventListener.apply(e,arguments)}),e);t.EventTargetMixin=a}()}),require.register("curvature/mixin/PromiseMixin.js",function(t,n,r){n=e(n,{},"curvature"),function(){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PromiseMixin=void 0;var e,r=n("../base/Mixin");function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var o=Symbol("Promise"),a=Symbol("Accept"),s=Symbol("Reject"),u=(i(e={},r.Mixin.Constructor,function(){var e=this;this[o]=new Promise(function(t,n){e[a]=t,e[s]=n})}),i(e,"then",function(){var e;return(e=this[o]).then.apply(e,arguments)}),i(e,"catch",function(){var e;return(e=this[o]).catch.apply(e,arguments)}),i(e,"finally",function(){var e;return(e=this[o]).finally.apply(e,arguments)}),e);t.PromiseMixin=u,Object.defineProperty(u,"Reject",{value:s}),Object.defineProperty(u,"Accept",{value:a})}()}),require.register("matrix-api/Matrix.js",function(t,n,r){n=e(n,{},"matrix-api"),function(){"use strict";function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Matrix=void 0;var r=n("curvature/base/Mixin"),i=n("curvature/mixin/EventTargetMixin");function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);a=!0);}catch(e){s=!0,i=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw i}}return o}}(e,t)||function(e,t){if(e){if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(t,n){if(n&&("object"===e(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(t)}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(i,e);var t,n,r=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=l(e);if(t){var i=l(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return c(this,n)}}(i);function i(e){var t;return function(e,t){if(!(e instanceof i))throw new TypeError("Cannot call a class as a function")}(this),(t=r.call(this)).baseUrl=e||"https://matrix.org/_matrix",t.clientUrl="".concat(t.baseUrl,"/client/r0"),t.mediaUrl="".concat(t.baseUrl,"/media/r0"),t.profileCache=new Map,t.mediaCache=new Map,t}return t=i,(n=[{key:"isLoggedIn",get:function(){sessionStorage.getItem("matrix:access-token")&&this.dispatchEvent(new CustomEvent("logged-in"));var e=sessionStorage.getItem("matrix:access-token")||"false";return JSON.parse(e),sessionStorage.getItem("matrix:access-token")}},{key:"initSso",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window,r="login/sso/redirect?redirectUrl="+e,i=window.screenX+window.outerWidth/2+200,o=window.screenY+window.outerHeight/2-300,a="width=".concat(400,",height=").concat(600,",screenX=").concat(i,",screenY=").concat(o),s=(n.open("".concat(this.clientUrl,"/").concat(r),"matrix-login",a),function(e){if(e.origin===location.origin&&e.source!==window&&"string"==typeof e.data){var n=JSON.parse(e.data);"s.sso.complete"===n.type&&(sessionStorage.setItem("matrix:access-token",JSON.stringify(n.data)),t.dispatchEvent(new CustomEvent("logged-in")))}});n.addEventListener("message",s)}},{key:"completeSso",value:function(e){var t={type:"m.login.token",token:e,txn_id:(1/Math.random()).toString(36)};fetch("".concat(this.clientUrl,"/").concat("login"),{method:"POST",body:JSON.stringify(t)}).then(function(e){return e.json()}).then(function(e){window.opener.postMessage(JSON.stringify({type:"s.sso.complete",data:e}),location.origin),window.close()})}},{key:"getGuestToken",value:function(){var e=sessionStorage.getItem("matrix:access-token")||"false",t=JSON.parse(e);if(t&&t.isGuest)return Promise.resolve(t);var n=fetch("".concat(this.clientUrl,"/register?kind=guest"),{method:"POST",body:"{}"}).then(function(e){return e.json()});return n.then(function(e){e.isGuest=!0,sessionStorage.setItem("matrix:access-token",JSON.stringify(e))}),n}},{key:"getToken",value:function(){var e=sessionStorage.getItem("matrix:access-token")||"false",t=JSON.parse(e);return t?Promise.resolve(t):matrix.getGuestToken()}},{key:"listenForServerEvents",value:function(){var e=this,t=JSON.parse(sessionStorage.getItem("matrix:access-token")||"false");if(!t)return Promise.reject("No access token found.");var n="".concat(this.clientUrl,"/events?access_token=").concat(t.access_token);fetch(n).then(function(e){return e.json()}).then(function(t){return e.streamServerEvents(t)})}},{key:"listenForRoomEvents",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(!t||!t.cancelled){var i=JSON.parse(sessionStorage.getItem("matrix:access-token")||"false");if(!i)return Promise.reject("No access token found.");var o="".concat(this.clientUrl,"/events?room_id=").concat(e,"&access_token=").concat(i.access_token,"&from=").concat(r);return t=t||{cancelled:!1},fetch(o).then(function(e){return e.json()}).then(function(r){return n.streamServerEvents(r,e,t)}),t}}},{key:"getUserProfile",value:function(e){if(this.profileCache.has(e))return this.profileCache.get(e);var t=fetch("".concat(this.clientUrl,"/profile/").concat(e)).then(function(e){return e.json()});return this.profileCache.set(e,t),t}},{key:"getUserData",value:function(e){var t=JSON.parse(sessionStorage.getItem("matrix:access-token")||"false");return t?fetch("".concat(this.clientUrl,"/user/").concat(t.user_id,"/account_data/").concat(e,"?access_token=").concat(t.access_token)).then(function(e){return e.json()}):Promise.reject("No access token found.")}},{key:"putUserData",value:function(e,t){var n=JSON.parse(sessionStorage.getItem("matrix:access-token")||"false");if(n){var r="".concat(this.clientUrl,"/user/").concat(n.user_id,"/account_data/").concat(e,"?access_token=").concat(n.access_token);return fetch(r,{method:"PUT",body:t}).then(function(e){if(!e.ok){var t=new Error("HTTP status code: "+e.status);throw t.status=e.status,t.response=e,t}return e}).then(function(e){return e.json()})}}},{key:"getMediaUrl",value:function(e){var t=new URL(e);return"".concat(this.mediaUrl,"/download/").concat(t.pathname.substr(2))}},{key:"getMedia",value:function(e){if(this.mediaCache.has(e))return this.mediaCache.get(e);var t=fetch(this.getMediaUrl(e)).then(function(e){return Promise.all([e.arrayBuffer(),e.headers.get("Content-type")])}).then(function(e){var t=o(e,2),n=t[0],r=t[1];return URL.createObjectURL(new Blob([n],{type:r}))});return this.mediaCache.set(e,t),t}},{key:"postMedia",value:function(e,t){var n=sessionStorage.getItem("matrix:access-token")||"false",r=JSON.parse(n);if(r){var i="".concat(this.mediaUrl,"/upload?access_token=").concat(r.access_token),o=new Headers({"Content-Type":e.type});return fetch(i,{method:"POST",headers:o,body:e}).then(function(e){return e.json()})}}},{key:"putEvent",value:function(e,t,n){var r=sessionStorage.getItem("matrix:access-token")||"false",i=JSON.parse(r);if(i){var o="".concat(this.clientUrl,"/rooms/").concat(e,"/send/").concat(t,"/").concat(Math.random().toString(36),"?access_token=").concat(i.access_token),a={method:"PUT",headers:new Headers({"Content-Type":"application/json"}),body:JSON.stringify(n)};return fetch(o,a).then(function(e){return e.json()})}}},{key:"getEvent",value:function(e,t){var n=sessionStorage.getItem("matrix:access-token")||"false",r=JSON.parse(n);if(r){var i="".concat(this.clientUrl,"/rooms/").concat(e,"/event/").concat(t,"?access_token=").concat(r.access_token),o=new Headers({"Content-Type":"application/json"});return fetch(i,{method:"GET",headers:o}).then(function(e){return e.json()})}}},{key:"sync",value:function(){var e=sessionStorage.getItem("matrix:access-token")||"false",t=JSON.parse(e);if(!t)return Promise.resolve();var n="".concat(this.clientUrl,"/sync?full_state=true&access_token=").concat(t.access_token);return fetch(n).then(function(e){return e.json()})}},{key:"getRoomState",value:function(e){var t=sessionStorage.getItem("matrix:access-token")||"false",n=JSON.parse(t);if(!n)return Promise.resolve();var r="".concat(this.clientUrl,"/rooms/").concat(e,"/state?access_token=").concat(n.access_token);return fetch(r).then(function(e){return e.json()})}},{key:"syncRoom",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=JSON.parse(sessionStorage.getItem("matrix:access-token")||"false");if(!n)return Promise.reject("No access token found.");var r="".concat(this.clientUrl,"/rooms/").concat(e,"/messages?dir=b&room_id=").concat(e,"&access_token=").concat(n.access_token,"&from=").concat(t);return fetch(r).then(function(e){return e.json()})}},{key:"syncRoomHistory",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return this.syncRoom(e,t).then(function(t){var i=new CustomEvent("roomSyncFrame",{detail:{frame:t},cancelable:!0});if(n.dispatchEvent(i))return t.chunk&&r&&t.chunk.forEach(r),new Promise(function(i){setTimeout(function(){return i(t.chunk.length&&n.syncRoomHistory(e,t.end,r))},100)})})}},{key:"streamServerEvents",value:function(e,t,n){var r=this;n&&n.cancelled||(t?this.listenForRoomEvents(t,n,e.end):this.listenForServerEvents(),e.chunk&&e.chunk.forEach(function(e){var t={};e.event_id||(e.event_id="local:"+(1/Math.random()).toString(36)),Object.assign(t,e),r.dispatchEvent(new CustomEvent("matrix-event",{detail:t})),r.dispatchEvent(new CustomEvent(t.type,{detail:t}))}))}},{key:"getCurrentUserId",value:function(){var e=sessionStorage.getItem("matrix:access-token")||"false",t=JSON.parse(e);if(t)return t.user_id}},{key:"createRoom",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=JSON.stringify({name:e,topic:t,visibility:n,initial_state:r}),o=JSON.parse(sessionStorage.getItem("matrix:access-token")||"false");if(!o)return Promise.resolve();var a="".concat(this.clientUrl,"/createRoom?access_token=").concat(o.access_token);return fetch(a,{body:i,method:"POST"}).then(function(e){return e.json()})}},{key:"joinRoom",value:function(e){var t=JSON.parse(sessionStorage.getItem("matrix:access-token")||"false");if(!t)return Promise.reject("No access token found.");fetch("".concat(this.clientUrl,"/rooms/").concat(e,"/join?access_token=").concat(t.access_token),{method:"POST"}).then(function(e){return e.json()})}},{key:"leaveRoom",value:function(e){var t=JSON.parse(sessionStorage.getItem("matrix:access-token")||"false");if(!t)return Promise.reject("No access token found.");fetch("".concat(this.clientUrl,"/rooms/").concat(e,"/leave?access_token=").concat(t.access_token),{method:"POST"}).then(function(e){return e.json()})}},{key:"whoAmI",value:function(){var e=JSON.parse(sessionStorage.getItem("matrix:access-token")||"false");return e?fetch("".concat(this.clientUrl,"/account/whoami?access_token=").concat(e.access_token)).then(function(e){return e.json()}):Promise.reject("No access token found.")}}])&&s(t.prototype,n),i}(r.Mixin.with(i.EventTargetMixin));t.Matrix=f}()}),require.register("matrix-api/node_modules/curvature/base/Bindable.js",function(t,n,r){n=e(n,{},"matrix-api/node_modules/curvature"),function(){"use strict";function e(t,r,i){return(e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}()?Reflect.construct:function(e,t,r){var i=[null];i.push.apply(i,t);var o=new(Function.bind.apply(e,i));return r&&n(o,r.prototype),o}).apply(null,arguments)}function n(e,t){return(n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function r(e){return function(e){if(Array.isArray(e))return a(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||o(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=o(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){u=!0,a=e},f:function(){try{s||null==n.return||n.return()}finally{if(u)throw a}}}}function o(e,t){if(e){if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Object.defineProperty(t,"__esModule",{value:!0}),t.Bindable=void 0;var l=Symbol("ref"),f=Symbol("original"),d=Symbol("deck"),p=Symbol("binding"),v=Symbol("subBinding"),h=Symbol("bindingAll"),y=Symbol("isBindable"),b=Symbol("wrapping"),m=Symbol("Names"),g=Symbol("executing"),w=Symbol("stack"),O=(Symbol("object"),Symbol("wrapped")),x=Symbol("unwrapped"),k=Symbol("getProto"),j=Symbol("onGet"),S=Symbol("onAllGet"),P=Symbol("bindChain"),_=Symbol("Descriptors"),C=Symbol("Before"),T=Symbol("After"),E=Symbol("NoGetters"),A=Object.getPrototypeOf(Int8Array),R=Set.prototype[Symbol.iterator],M=Map.prototype[Symbol.iterator],z=globalThis,I=[z.Node,z.File,z.Map,z.Set,z.WeakMap,z.WeakSet,z.ArrayBuffer,z.ResizeObserver,z.MutationObserver,z.PerformanceObserver,z.IntersectionObserver,z.IDBCursor,z.IDBCursorWithValue,z.IDBDatabase,z.IDBFactory,z.IDBIndex,z.IDBKeyRange,z.IDBObjectStore,z.IDBOpenDBRequest,z.IDBRequest,z.IDBTransaction,z.IDBVersionChangeEvent,z.Event,z.CustomEvent,z.FileSystemFileHandle].filter(function(e){return"function"==typeof e}),B=function(){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t)}var n,o;return n=t,o=[{key:"isBindable",value:function(e){return!(!e||!e[y])&&e[y]===t}},{key:"onDeck",value:function(e,t){return e[d][t]||!1}},{key:"ref",value:function(e){return e[l]||e||!1}},{key:"makeBindable",value:function(e){return this.make(e)}},{key:"shuck",value:function(e,n){n=n||new Map;var r={};if(e instanceof A||e instanceof ArrayBuffer){var i=e.slice(0);return n.set(e,i),i}var o=Object.keys(e);for(var a in o){var u=o[a];if("___"!==u.substring(0,3)){var c=n.get(e[u]);if(c)r[u]=c;else if(e[u]!==e){if(e[u]&&"object"===s(e[u])){var l=e[u];t.isBindable(e[u])&&(l=e[u][f]),r[u]=this.shuck(l,n)}else r[u]=e[u];n.set(e[u],r[u])}else n.set(e[u],r),r[u]=r}}return t.isBindable(e)&&(delete r.bindTo,delete r.isBound),r}},{key:"make",value:function(n){var o=this;if(!n||!["function","object"].includes(s(n)))return n;if(n[l])return n[l];if(n[y])return n;if(Object.isSealed(n)||Object.isFrozen(n)||!Object.isExtensible(n)||I.filter(function(e){return n instanceof e}).length)return n;Object.defineProperty(n,y,{configurable:!1,enumerable:!1,writable:!1,value:t}),Object.defineProperty(n,l,{configurable:!0,enumerable:!1,writable:!0,value:!1}),Object.defineProperty(n,f,{configurable:!1,enumerable:!1,writable:!1,value:n}),Object.defineProperty(n,d,{configurable:!1,enumerable:!1,writable:!1,value:{}}),Object.defineProperty(n,p,{configurable:!1,enumerable:!1,writable:!1,value:{}}),Object.defineProperty(n,v,{configurable:!1,enumerable:!1,writable:!1,value:new Map}),Object.defineProperty(n,h,{configurable:!1,enumerable:!1,writable:!1,value:[]}),Object.defineProperty(n,g,{enumerable:!1,writable:!0}),Object.defineProperty(n,b,{enumerable:!1,writable:!0}),Object.defineProperty(n,w,{configurable:!1,enumerable:!1,writable:!1,value:[]}),Object.defineProperty(n,C,{configurable:!1,enumerable:!1,writable:!1,value:[]}),Object.defineProperty(n,T,{configurable:!1,enumerable:!1,writable:!1,value:[]}),Object.defineProperty(n,O,{configurable:!1,enumerable:!1,writable:!1,value:Object.preventExtensions(new Map)}),Object.defineProperty(n,x,{configurable:!1,enumerable:!1,writable:!1,value:{}}),Object.defineProperty(n,_,{configurable:!1,enumerable:!1,writable:!1,value:Object.preventExtensions(new Map)}),Object.defineProperty(n,"bindTo",{configurable:!1,enumerable:!1,writable:!1,value:function e(r){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},u=!1;if(Array.isArray(r)){var c=r.forEach(function(t){return e(t,i,a)});return function(){return c.forEach(function(e){return e()})}}if(r instanceof Function&&(a=i||{},i=r,u=!0),a.delay>=0&&(i=o.wrapDelayCallback(i,a.delay)),a.throttle>=0&&(i=o.wrapThrottleCallback(i,a.throttle)),a.wait>=0&&(i=o.wrapWaitCallback(i,a.wait)),a.frame&&(i=o.wrapFrameCallback(i,a.frame)),a.idle&&(i=o.wrapIdleCallback(i)),u){var l=n[h].length;if(n[h].push(i),!("now"in a)||a.now)for(var f in n)i(n[f],f,n,!1);return function(){delete n[h][l]}}if(n[p][r]||(n[p][r]=new Set),a.children){var d=i;i=function(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];var o=r[0],u=n[v].get(d);if(u&&(n[v].delete(d),u()),"object"===s(o)){var c=t.make(o);t.isBindable(c)&&n[v].set(d,c.bindTo(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return d.apply(void 0,r.concat(t))},Object.assign({},a,{children:!1}))),d.apply(void 0,r)}else d.apply(void 0,r)}}n[p][r].add(i),"now"in a&&!a.now||i(n[r],r,n,!1);var y=function(){var e=n[v].get(i);e&&(n[v].delete(i),e()),n[p][r]&&n[p][r].has(i)&&n[p][r].delete(i)};return a.removeWith&&a.removeWith instanceof View&&a.removeWith.onRemove(function(){return y}),y}}),Object.defineProperty(n,P,{configurable:!1,enumerable:!1,writable:!1,value:function(e,t){var r=e.split("."),i=r.shift(),a=r.slice(0),s=[];return s.push(n.bindTo(i,function(e,n,r,i){var u=a.join(".");0!==a.length?(void 0===e&&(e=r[n]=o.make({})),s=s.concat(e[P](u,t))):t(e,n,r,i)})),function(){return s.forEach(function(e){return e()})}}}),Object.defineProperty(n,"___before",{configurable:!1,enumerable:!1,writable:!1,value:function(e){var t=n[C].length;n[C].push(e);var r=!1;return function(){r||(r=!0,delete n[C][t])}}}),Object.defineProperty(n,"___after",{configurable:!1,enumerable:!1,writable:!1,value:function(e){var t=n[T].length;n[T].push(e);var r=!1;return function(){r||(r=!0,delete n[T][t])}}}),Object.defineProperty(n,"isBound",{configurable:!1,enumerable:!1,writable:!1,value:function(){for(var e in n[h])if(n[h][e])return!0;for(var t in n[p])for(var r in n[p][t])if(n[p][t][r])return!0;return!1}});var a=function(e){n[e]&&n[e]instanceof Object&&!n[e]instanceof Promise&&(I.filter(function(t){return n[e]instanceof t}).length||!Object.isExtensible(n[e])||Object.isSealed(n[e])||(n[e]=t.make(n[e])))};for(var u in n)a(u);var c=n[_],z=n[O],B=n[w],D={get:function(r,o){if(z.has(o))return z.get(o);if(o===l||o===f||"apply"===o||"isBound"===o||"bindTo"===o||"__proto__"===o||"constructor"===o)return n[o];var a;if(c.has(o)?a=c.get(o):(a=Object.getOwnPropertyDescriptor(n,o),c.set(o,a)),a&&!a.configurable&&!a.writable)return n[o];if(S in n)return n[S](o);if(j in n&&!(o in n))return n[j](o);if(a&&!a.configurable&&!a.writable)return z.set(o,n[o]),n[o];if("function"==typeof n[o]){if(m in n[o])return n[o];Object.defineProperty(n[x],o,{configurable:!1,enumerable:!1,writable:!0,value:n[o]});var s=Object.getPrototypeOf(n)[o]===n[o],u="function"==typeof Promise&&n instanceof Promise||"function"==typeof Map&&n instanceof Map||"function"==typeof Set&&n instanceof Set||"function"==typeof M&&n.prototype===M||"function"==typeof R&&n.prototype===R||"function"==typeof R&&n.prototype===R||"function"==typeof WeakMap&&n instanceof WeakMap||"function"==typeof WeakSet&&n instanceof WeakSet||"function"==typeof Date&&n instanceof Date||"function"==typeof A&&n instanceof A||"function"==typeof ArrayBuffer&&n instanceof ArrayBuffer||"function"==typeof EventTarget&&n instanceof EventTarget||"function"==typeof ResizeObserver&&n instanceof ResizeObserver||"function"==typeof MutationObserver&&n instanceof MutationObserver||"function"==typeof PerformanceObserver&&n instanceof PerformanceObserver||"function"==typeof IntersectionObserver&&n instanceof IntersectionObserver||"function"==typeof n[Symbol.iterator]&&"next"===o?n:n[l],d=function(){n[g]=o,B.unshift(o);for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];var c,l,f=i(n[C]);try{for(f.s();!(c=f.n()).done;){(0,c.value)(n,o,B,n,r)}}catch(e){f.e(e)}finally{f.f()}if(new.target)l=e(n[x][o],r);else{var d=n[x][o];l=s?d.apply(u||n,r):d.apply(void 0,r)}var p,v=i(n[T]);try{for(v.s();!(p=v.n()).done;){(0,p.value)(n,o,B,n,r)}}catch(e){v.e(e)}finally{v.f()}return n[g]=null,B.shift(),l};(d[m]=d[m]||new WeakMap).set(n,o),d[S]=function(e){var t=d[m].get(n);return n[t][e]};var p=t.make(d);return z.set(o,p),p}return n[o]},set:function(e,r,o){if(z.has(r)&&z.delete(r),r===f)return!0;var a=n[d];if(r in a&&a[r]===o)return!0;if(r.slice&&"___"===r.slice(-3))return!0;if(e[r]===o||"number"==typeof o&&isNaN(a[r])&&isNaN(o))return!0;for(var s in o&&o instanceof Object&&(I.filter(function(e){return n instanceof e}).length||!Object.isExtensible(n)||Object.isSealed(n)||(n[E],o=t.make(o))),a[r]=o,n[h])n[h][s]&&n[h][s](o,r,e,!1);var u=!1;if(r in n[p]){var c,l=i(n[p][r]);try{for(l.s();!(c=l.n()).done;)!1===(0,c.value)(o,r,e,!1,e[r])&&(u=!0)}catch(e){l.e(e)}finally{l.f()}}if(delete a[r],!u){var v=Object.getOwnPropertyDescriptor(e,r);e instanceof File&&"lastModifiedDate"==r||v&&!v.writable||e[r]!==o||(e[r]=o)}var y=Reflect.set(e,r,o);if(Array.isArray(e)&&n[p].length)for(var b in n[p].length)(0,n[p].length[b])(e.length,"length",e,!1,e.length);return y},construct:function(i,o){var a="constructor";for(var s in i[C])i[C][s](i,a,n[w],void 0,o);var u=t.make(e(i[f],r(o)));for(var c in i[T])i[T][c](i,a,n[w],u,o);return u},getPrototypeOf:function(e){return k in n?n[k]:Reflect.getPrototypeOf(e)},deleteProperty:function(e,t){var r=n[d];if(void 0!==r[t])return!0;if(!(t in e))return!0;if(c.has(t)){var o=c.get(t);if(o&&!o.configurable)return!1;c.delete(t)}for(var a in r[t]=null,z.has(t)&&z.delete(t),n[h])n[h][a](void 0,t,e,!0,e[t]);if(t in n[p]){var s,u=i(n[p][t]);try{for(u.s();!(s=u.n()).done;)(0,s.value)(void 0,t,e,!0,e[t])}catch(e){u.e(e)}finally{u.f()}}return delete r[t],delete e[t],!0}};return n[E]&&delete D.get,Object.defineProperty(n,l,{configurable:!1,enumerable:!1,writable:!1,value:new Proxy(n,D)}),n[l]}},{key:"clearBindings",value:function(e){var t;(t=function(e){return Object.keys(e).map(function(t){return delete e[t]})},function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return n.map(t)})(e[O],e[p],e[h],e[T],e[C])}},{key:"resolve",value:function(e,t){for(var n,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=t.split("."),o=i[0];i.length;){if(r&&1===i.length)return[this.make(e),i.shift(),o];!(!(n=i.shift())in e)&&e[n]&&e[n]instanceof Object||(e[n]={}),e=this.make(e[n])}return[this.make(e),n,o]}},{key:"wrapDelayCallback",value:function(e,t){return function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return setTimeout(function(){return e.apply(void 0,r)},t)}}},{key:"wrapThrottleCallback",value:function(e,t){var n=this;return this.throttles.set(e,!1),function(){n.throttles.get(e,!0)||(e.apply(void 0,arguments),n.throttles.set(e,!0),setTimeout(function(){n.throttles.set(e,!1)},t))}}},{key:"wrapWaitCallback",value:function(e,t){var n=this;return function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];var a;(a=n.waiters.get(e))&&(n.waiters.delete(e),clearTimeout(a)),a=setTimeout(function(){return e.apply(void 0,i)},t),n.waiters.set(e,a)}}},{key:"wrapFrameCallback",value:function(e,t){return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];requestAnimationFrame(function(){return e.apply(void 0,n)})}}},{key:"wrapIdleCallback",value:function(e){return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];(window.requestIdleCallback||requestAnimationFrame)(function(){return e.apply(void 0,n)})}}}],null&&u(n.prototype,null),o&&u(n,o),Object.defineProperty(n,"prototype",{writable:!1}),t}();t.Bindable=B,c(B,"waiters",new WeakMap),c(B,"throttles",new WeakMap),Object.defineProperty(B,"OnGet",{configurable:!1,enumerable:!1,writable:!1,value:j}),Object.defineProperty(B,"NoGetters",{configurable:!1,enumerable:!1,writable:!1,value:E}),Object.defineProperty(B,"GetProto",{configurable:!1,enumerable:!1,writable:!1,value:k}),Object.defineProperty(B,"OnAllGet",{configurable:!1,enumerable:!1,writable:!1,value:S})}()}),require.register("matrix-api/node_modules/curvature/base/Mixin.js",function(t,n,r){n=e(n,{},"matrix-api/node_modules/curvature"),function(){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Mixin=void 0;var e=n("./Bindable");function r(e){return function(e){if(Array.isArray(e))return s(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||a(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=a(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){u=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(u)throw o}}}}function a(e,t){if(e){if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,t):void 0}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return l(e)}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function v(e,t,n){return t&&p(e.prototype,t),n&&p(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var h=Symbol("constructor"),y=(Symbol("mixinList"),function(){function t(){d(this,t)}return v(t,null,[{key:"from",value:function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];return function(n){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(s,e);var a=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=f(e);if(t){var i=f(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return c(this,n)}}(s);function s(){var n;d(this,s);for(var u=arguments.length,f=new Array(u),p=0;p<u;p++)f[p]=arguments[p];var v,h=e.constructor?n=a.call.apply(a,[this].concat(f)):null,y=o(r);try{for(y.s();!(v=y.n()).done;){var b=v.value;switch(b[t.Constructor]&&b[t.Constructor].apply(l(n)),i(b)){case"function":t.mixClass(b,s);break;case"object":t.mixObject(b,l(n))}}}catch(e){y.e(e)}finally{y.f()}return c(n,h)}return v(s)}()}},{key:"make",value:function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var i=n.pop();return t.to.apply(t,[i].concat(n))}},{key:"to",value:function(e){for(var t={},n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];r.map(function(n){switch(i(n)){case"object":Object.assign(t,Object.getOwnPropertyDescriptors(n));break;case"function":Object.assign(t,Object.getOwnPropertyDescriptors(n.prototype))}delete t.constructor,Object.defineProperties(e.prototype,t)})}},{key:"with",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.from.apply(this,[v(function e(){d(this,e)})].concat(t))}},{key:"mixObject",value:function(e,t){var n,r=o(Object.getOwnPropertyNames(e));try{for(r.s();!(n=r.n()).done;){var i=n.value;"function"!=typeof e[i]?t[i]=e[i]:t[i]=e[i].bind(t)}}catch(e){r.e(e)}finally{r.f()}var a,s=o(Object.getOwnPropertySymbols(e));try{for(s.s();!(a=s.n()).done;){var u=a.value;"function"!=typeof e[u]?t[u]=e[u]:t[u]=e[u].bind(t)}}catch(e){s.e(e)}finally{s.f()}}},{key:"mixClass",value:function(e,t){var n,r=o(Object.getOwnPropertyNames(e.prototype));try{for(r.s();!(n=r.n()).done;){var i=n.value;if(!["name","prototype","length"].includes(i)){var a=Object.getOwnPropertyDescriptor(t,i);a&&!a.writable||("function"==typeof e[i]?t.prototype[i]=e.prototype[i].bind(t.prototype):t.prototype[i]=e.prototype[i])}}}catch(e){r.e(e)}finally{r.f()}var s,u=o(Object.getOwnPropertySymbols(e.prototype));try{for(u.s();!(s=u.n()).done;){var c=s.value;"function"==typeof e[c]?t.prototype[c]=e.prototype[c].bind(t.prototype):t.prototype[c]=e.prototype[c]}}catch(e){u.e(e)}finally{u.f()}var l,f=o(Object.getOwnPropertyNames(e));try{var d=function(){var n=l.value;if(["name","prototype","length"].includes(n))return"continue";var r=Object.getOwnPropertyDescriptor(t,n);if(r&&!r.writable)return"continue";if("function"!=typeof e[n])return t[n]=e[n],"continue";var i=t[n]||!1,o=e[n].bind(t);t[n]=function(){return i&&i.apply(void 0,arguments),o.apply(void 0,arguments)}};for(f.s();!(l=f.n()).done;)d()}catch(e){f.e(e)}finally{f.f()}var p,v=o(Object.getOwnPropertySymbols(e));try{var h=function(){var n=p.value;if("function"!=typeof e[n])return t.prototype[n]=e[n],"continue";var r=t[n]||!1,i=e[n].bind(t);t[n]=function(){return r&&r.apply(void 0,arguments),i.apply(void 0,arguments)}};for(v.s();!(p=v.n()).done;)h()}catch(e){v.e(e)}finally{v.f()}}},{key:"mix",value:function(t){for(var n={},i={},a=e.Bindable.makeBindable(t),s=function(e){var t,s=Object.getOwnPropertyNames(e.prototype),u=/^(before|after)__(.+)/,c=o(Object.getOwnPropertyNames(e));try{var l=function(){var i=t.value,o=i.match(u);if(o){switch(o[1]){case"before":a.___before(function(t,n,a,s,u){if(n===o[2])return e[i].bind(s).apply(void 0,r(u))});break;case"after":a.___after(function(t,n,a,s,u){if(n===o[2])return e[i].bind(s).apply(void 0,r(u))})}return"continue"}return n[i]||"function"!=typeof e[i]?"continue":void(n[i]=e[i])};for(c.s();!(t=c.n()).done;)l()}catch(e){c.e(e)}finally{c.f()}var f,d=o(s);try{var p=function(){var t=f.value,n=t.match(u);if(n){switch(n[1]){case"before":a.___before(function(i,o,a,s,u){if(o===n[2])return e.prototype[t].bind(s).apply(void 0,r(u))});break;case"after":a.___after(function(i,o,a,s,u){if(o===n[2])return e.prototype[t].bind(s).apply(void 0,r(u))})}return"continue"}return i[t]||"function"!=typeof e.prototype[t]?"continue":void(i[t]=e.prototype[t])};for(d.s();!(f=d.n()).done;)p()}catch(e){d.e(e)}finally{d.f()}},u=this;u&&u.prototype;u=Object.getPrototypeOf(u))s(u);for(var c in n)t[c]=n[c].bind(t);var l=function(e){t.prototype[e]=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return i[e].apply(this,n)}};for(var f in i)l(f);return a}}]),t}());t.Mixin=y,y.Constructor=h}()}),require.register("matrix-api/node_modules/curvature/mixin/EventTargetMixin.js",function(t,n,r){n=e(n,{},"matrix-api/node_modules/curvature"),function(){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EventTargetMixin=void 0;var e,r=n("../base/Mixin");function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var o=Symbol("Target"),a=(i(e={},r.Mixin.Constructor,function(){try{this[o]=new EventTarget}catch(e){this[o]=document.createDocumentFragment()}}),i(e,"dispatchEvent",function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=n[0];"string"==typeof i&&(i=new CustomEvent(i),n[0]=i),(e=this[o]).dispatchEvent.apply(e,n);var a="on".concat(i.type[0].toUpperCase()+i.type.slice(1));return"function"==typeof this[a]&&this[a](i),i.returnValue}),i(e,"addEventListener",function(){var e;(e=this[o]).addEventListener.apply(e,arguments)}),i(e,"removeEventListener",function(){var e;(e=this[o]).removeEventListener.apply(e,arguments)}),e);t.EventTargetMixin=a}()}),require.register("chat/Chat.js",function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(e,"__esModule",{value:!0}),e.Chat=void 0;var i=t("curvature/base/View"),o=t("./Inbox"),a=t("./Outbox");function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=d(e);if(t){var i=d(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return l(this,n)}}function l(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return f(e)}function f(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var p=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(i,e);var t,n,r=c(i);function i(e,t){var n,s,u,c;!function(e,t){if(!(e instanceof i))throw new TypeError("Cannot call a class as a function")}(this),c='<div class = "chat-box">\n\t\t<div class = "chat-wrapper">[[inbox]]</div>\n\t\t[[outbox]]\n\t</div>',(u="template")in(s=f(n=r.call(this,e,t)))?Object.defineProperty(s,u,{value:c,enumerable:!0,configurable:!0,writable:!0}):s[u]=c;var l=new a.Outbox({},f(n)),d=new o.Inbox({},f(n));return l.addEventListener("send",function(e){return n.handleSend(e)}),n.args.outbox=l,n.args.inbox=d,n}return t=i,(n=[{key:"handleSend",value:function(e){var t=e.detail;this.args.inbox.args.messages.push({user:this.args.myId,text:t.input}),this.dispatchEvent(new CustomEvent("send",{detail:t}))}},{key:"handleMessage",value:function(e){var t=e.detail;this.args.inbox.args.messages.push({user:t.user_id,text:t.content.body})}}])&&s(t.prototype,n),i}(i.View);e.Chat=p}),require.register("chat/Inbox.js",function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return a(e)}function a(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(e,"__esModule",{value:!0}),e.Inbox=void 0;var u=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(n,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=s(e);if(t){var i=s(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return o(this,n)}}(n);function n(e,r){var i,o,s,u;return function(e,t){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this),u='<div class = "chat-inbox" cv-each = "messages:message">\n\t\t<p><b>[[message.user]]:</b> [[message.text]]</p>\n\t</div>',(s="template")in(o=a(i=t.call(this,e,r)))?Object.defineProperty(o,s,{value:u,enumerable:!0,configurable:!0,writable:!0}):o[s]=u,i.args.messages=[],i}return n}(t("curvature/base/View").View);e.Inbox=u}),require.register("chat/Outbox.js",function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function a(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=c(e);if(t){var i=c(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return s(this,n)}}function s(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return u(e)}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(e,"__esModule",{value:!0}),e.Outbox=void 0;var l=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&o(e,t)}(s,e);var t,n,r=a(s);function s(e,t){var n,i,o,a;return function(e,t){if(!(e instanceof s))throw new TypeError("Cannot call a class as a function")}(this),a='<form class = "chat-outbox" cv-on = "submit">\n\t\t<input type = "text" cv-ref = "input" cv-bind = "input" />\n\t\t<input type = "submit">\n\t</form>',(o="template")in(i=u(n=r.call(this,e,t)))?Object.defineProperty(i,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):i[o]=a,n}return t=s,(n=[{key:"submit",value:function(e){e.preventDefault();var t=this.args.input;this.dispatchEvent(new CustomEvent("send",{detail:{input:t,event:e}})),this.args.input="",this.tags.input.focus()}}])&&i(t.prototype,n),s}(t("curvature/base/View").View);e.Outbox=l}),require.register("cubes/Barrel.js",function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function a(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=c(e);if(t){var i=c(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return s(this,n)}}function s(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return u(e)}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(e,"__esModule",{value:!0}),e.Barrel=void 0;var l=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&o(e,t)}(c,t("./Cube").Cube);var n,r,s=a(c);function c(e,n){var r,i,o,a;return function(e,t){if(!(e instanceof c))throw new TypeError("Cannot call a class as a function")}(this),i=u(r=s.call(this,e,n)),o="template",a=t("./cube.html"),o in i?Object.defineProperty(i,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):i[o]=a,r.args.css="barrel",r}return n=c,(r=[{key:"collide",value:function(e){if(!e.args.solid&&(e.xSpeed||e.zSpeed)){var t=.5*(this.args.size+e.args.size)/32,n=.5*(this.args.size+e.args.size)/32,r=Math.atan2(this.args.z-e.args.z,this.args.x-e.args.x);t>Math.abs(this.args.x-e.args.x)&&Math.sign(this.args.x-e.args.x)===Math.sign(e.xSpeed)&&(this.args.x=e.args.x+1.01*t*Math.cos(r)+e.xSpeed),n>Math.abs(this.args.z-e.args.z)&&Math.sign(this.args.z-e.args.z)===Math.sign(e.zSpeed)&&(this.args.z=e.args.z+1.01*n*Math.sin(r)+e.zSpeed)}}}])&&i(n.prototype,r),c}();e.Barrel=l}),require.register("cubes/BarrelHole.js",function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(e,"__esModule",{value:!0}),e.BarrelHole=void 0;var i=t("./Cube"),o=t("./Barrel");function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=d(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}}).apply(this,arguments)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=d(e);if(t){var i=d(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return l(this,n)}}function l(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return f(e)}function f(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var p=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(l,e);var n,r,i=c(l);function l(e,n){var r,o,a,s;return function(e,t){if(!(e instanceof l))throw new TypeError("Cannot call a class as a function")}(this),o=f(r=i.call(this,e,n)),a="template",s=t("./barrel-hole.tmp"),a in o?Object.defineProperty(o,a,{value:s,enumerable:!0,configurable:!0,writable:!0}):o[a]=s,r.args.css="barrel-hole",r.eating=null,r.started=!1,r.dropping=!1,r}return n=l,(r=[{key:"update",value:function(e){var t=this;s(d(l.prototype),"update",this).call(this,e),this.eating&&(this.args.css="barrel-hole open"),this.eating&&this.started&&(this.eating.args.x=this.args.x+.01,this.eating.args.z=this.args.z+.01,this.eating.noClip=!0,this.eating.ySpeed=0,this.eating.args.y-=1),this.eating&&this.eating.args.y<this.args.y-128&&(this.args.css="barrel-hole closed",this.eating.sleeping=!0,this.eating=null,this.dropping=!0),this.dropping&&this.args.targets&&this.args.targets.forEach(function(e){e.args.y<-1024?t.dropping=!1:(e.noClip=!0,e.args.y-=5)})}},{key:"collide",value:function(e){var t=this;if(e!==this.eating)return e instanceof o.Barrel&&(this.eating=e,setTimeout(function(){return t.started=!0},200),this.eating.args.x=this.args.x+.01,this.eating.args.y=this.args.y+.01,this.eating.args.z=this.args.z+.01),s(d(l.prototype),"collide",this).call(this,e)}}])&&a(n.prototype,r),l}(i.Cube);e.BarrelHole=p}),require.register("cubes/Box.js",function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(){return(o="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=l(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}}).apply(this,arguments)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=l(e);if(t){var i=l(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return u(this,n)}}function u(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return c(e)}function c(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(e,"__esModule",{value:!0}),e.Box=void 0;var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(f,t("./Cube").Cube);var n,r,u=s(f);function f(e,n){var r,i,o,a;return function(e,t){if(!(e instanceof f))throw new TypeError("Cannot call a class as a function")}(this),i=c(r=u.call(this,e,n)),o="template",a=t("./box.html"),o in i?Object.defineProperty(i,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):i[o]=a,r.args.mass=1/0,r.args.interior=r.args.interior||!1,r.zoomStarted=!1,r}return n=f,(r=[{key:"update",value:function(){o(l(f.prototype),"update",this).call(this),this.parent.exterior&&(this.zoomStarted||(this.zoomStarted=Date.now()),this.parent.xCamTilt3dInput=-20+(-.5+Math.random()),this.parent.zCam3dInput=250+25*Math.sin((Date.now()-this.zoomStarted)/5e3),this.parent.yCam3dInput=50*Math.cos((Date.now()-this.zoomStarted)/250)-300,this.parent.xCam3dInput*=Math.random(),this.parent.xCam3dInput+=15*(-.5+Math.random()))}},{key:"collide",value:function(e){o(l(f.prototype),"collide",this).call(this,e),this.args.interior&&(this.parent.exterior=!0)}},{key:"leave",value:function(e){var t=this;o(l(f.prototype),"leave",this).call(this,e),this.args.interior&&this.parent.exterior&&(this.zoomStarted=!1,this.parent.exterior=!1,setTimeout(function(){},250),setTimeout(function(){t.parent.zCamTilt3dInput=0},550),setTimeout(function(){t.parent.xCamTilt3dInput=-25,t.parent.yCam3dInput=-64,t.parent.zCam3dInput=320},50))}}])&&i(n.prototype,r),f}();e.Box=f}),require.register("cubes/Chicken.js",function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(){return(o="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=l(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}}).apply(this,arguments)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=l(e);if(t){var i=l(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return u(this,n)}}function u(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return c(e)}function c(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Object.defineProperty(e,"__esModule",{value:!0}),e.Chicken=void 0;var d=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(u,e);var t,n,r=s(u);function u(e,t){var n;return function(e,t){if(!(e instanceof u))throw new TypeError("Cannot call a class as a function")}(this),f(c(n=r.call(this,e,t)),"xSpeed",0),f(c(n),"zSpeed",0),n.following=!1,n.args.size=64,n.args.css="chicken",n}return t=u,(n=[{key:"update",value:function(){if(this.xTurnTimer>0&&this.xTurnTimer--,this.zTurnTimer>0&&this.zTurnTimer--,this.following){var e,t;e=Math.abs(this.following.args.x-this.args.x)>4?.3*Math.sign(this.following.args.x-this.args.x):0,t=Math.abs(this.following.args.z-this.args.z)>4?.3*Math.sign(this.following.args.z-this.args.z):0,this.xTurnTimer||(Math.sign(this.xSpeed)&&Math.sign(this.xSpeed)!==Math.sign(e)&&(this.xTurnTimer=20),this.xSpeed=e),this.zTurnTimer||(Math.sign(this.zSpeed)&&Math.sign(this.zSpeed)!==Math.sign(t)&&(this.zTurnTimer=20),this.zSpeed=t)}o(l(u.prototype),"update",this).call(this)}},{key:"collide",value:function(e){e.args.main&&(this.following=e,o(l(u.prototype),"collide",this).call(this,e))}},{key:"setFace",value:function(e){var t=Math.atan2(this.zSpeed,this.xSpeed)/Math.PI;o(l(u.prototype),"setFace",this).call(this,e+-(100*t-100))}}])&&i(t.prototype,n),u}(t("./Cube").Cube);e.Chicken=d}),require.register("cubes/Coin.js",function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(){return(o="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=l(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}}).apply(this,arguments)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=l(e);if(t){var i=l(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return u(this,n)}}function u(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return c(e)}function c(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(e,"__esModule",{value:!0}),e.Coin=void 0;var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(f,t("./Cube").Cube);var n,r,u=s(f);function f(e,n){var r,i,o,a;return function(e,t){if(!(e instanceof f))throw new TypeError("Cannot call a class as a function")}(this),i=c(r=u.call(this,e,n)),o="template",a=t("./coin.html"),o in i?Object.defineProperty(i,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):i[o]=a,r.args.size=64,r.args.css="coin",r}return n=f,(r=[{key:"collide",value:function(e){var t=this;return e.args.solid?o(l(f.prototype),"collide",this).call(this,e):"collected"!==this.args.state?("coinCount"in e.args&&e.args.coinCount++,this.args.gone=!0,e.collect&&e.collect(this),requestAnimationFrame(function(){t.args.state="collected"}),setTimeout(function(){return t.args.state="idle"},5e3),setTimeout(function(){return t.args.gone=!1},5150),o(l(f.prototype),"collide",this).call(this,e)):void 0}}])&&i(n.prototype,r),f}();e.Coin=f}),require.register("cubes/Cube.js",function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(e,"__esModule",{value:!0}),e.Cube=void 0;var i=t("curvature/base/Tag"),o=t("curvature/base/View");function a(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){u=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw o}}}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=p(e);if(t){var i=p(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f(this,n)}}function f(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return d(e)}function d(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}t("curvature/base/Bindable");var h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(s,e);var n,r,o=l(s);function s(e,n){var r;return function(e,t){if(!(e instanceof s))throw new TypeError("Cannot call a class as a function")}(this),v(d(r=o.call(this,e,n)),"template",t("./cube.html")),v(d(r),"latestCollisions",new Set),v(d(r),"collisions",new Set),v(d(r),"sleeping",!1),v(d(r),"noClip",!1),r.args.size=r.args.size||128,r.args.x=r.args.x||0,r.args.y=r.args.y||0,r.args.z=r.args.z||0,r.args.w=r.args.w||1,r.args.h=r.args.h||1,r.args.d=r.args.d||1,r.grounded=!1,r.xSpeed=0,r.ySpeed=0,r.zSpeed=0,r.age=0,r.args.xAngle=0,r.args.yAngle=0,r.args.zAngle=0,r.args.rot=r.args.rot||0,r.args.rad=r.args.rad||0,r.args.state="idle",r.args.face="X",r.args.coinCount=0,r.args.solid=r.args.solid||!1,r.args.mass=1,r.args.id=r._id,r.gravity=2.25,r.moving=!1,r}return n=s,(r=[{key:"updateStart",value:function(e){this.latestCollisions.clear(),this.args.collided=!1,this.args.y<=0&&!this.noClip&&(this.args.y=0)}},{key:"takeInput",value:function(e,t){var n=t.xAxis||0,r=t.yAxis||0,i=e/100,o=Math.cos(i*Math.PI),a=Math.sin(i*Math.PI);this.xSpeed+=-o*n*(r?.1:.2),this.zSpeed+=-a*n*(r?.1:.2),this.xSpeed+=+a*r*(n?.1:.2),this.zSpeed+=-o*r*(n?.1:.2),1===t.b[0]&&this.grounded?this.ySpeed=34:-1===t.b[0]&&this.ySpeed>0&&(this.ySpeed*=.5)}},{key:"update",value:function(e){this.args.collided?this.args.colliding=!0:this.args.colliding=!1,this.args.x+=this.xSpeed,this.args.y+=this.ySpeed,this.args.z+=this.zSpeed,this.args.x=Number(Number(this.args.x).toFixed(3)),this.args.y=Number(Number(this.args.y).toFixed(3)),this.args.z=Number(Number(this.args.z).toFixed(3)),this.xSpeed*=.75,this.zSpeed*=.75,this.args.y<=0&&!this.noClip?(this.args.y=0,this.ySpeed=0,this.grounded=!0):this.ySpeed-=this.gravity,this.ySpeed<-40&&(this.ySpeed=-40);var t,n=a(this.collisions);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.latestCollisions.has(r)||this.leave(r)}}catch(e){n.e(e)}finally{n.f()}var i,o=a(this.latestCollisions);try{for(o.s();!(i=o.n()).done;){var s=i.value;this.collisions.add(s)}}catch(e){o.e(e)}finally{o.f()}Math.abs(this.xSpeed)<.001&&(this.xSpeed=0),Math.abs(this.ySpeed)<.001&&(this.ySpeed=0),Math.abs(this.zSpeed)<.001&&(this.zSpeed=0),(Math.abs(this.xSpeed)>.2||this.ySpeed||Math.abs(this.zSpeed)>.2)&&(this.moving?this.age%45==0&&this.dispatchEvent(new CustomEvent("keep-moving")):this.dispatchEvent(new CustomEvent("start-moving")),this.moving=!0),this.xSpeed||this.ySpeed||this.zSpeed||(this.moving&&this.dispatchEvent(new CustomEvent("stop-moving")),this.moving=!1),this.age++}},{key:"collide",value:function(e){this.latestCollisions.add(e),this.args.collided=!0}},{key:"leave",value:function(e){}},{key:"checkCollision",value:function(e){var t=this;if(t===e)return!1;if(t.args.solid&&e.args.solid)return!1;var n=4.001*Number.EPSILON,r=.5*(t.args.size*t.args.w+e.args.size*e.args.w)/32,i=t.args.x-e.args.x;if(Math.abs(i)+-n>r)return!1;var o=.5*(t.args.size*t.args.d+e.args.size*e.args.d)/32,a=t.args.z-e.args.z;if(Math.abs(a)+-n>o)return!1;var s=e.getSlope(t.args.x,t.args.z),u=t.getSlope(e.args.x,e.args.z),c=t.args.y-e.args.y;if(t.args.y>e.args.y&&Math.abs(t.args.y-e.args.y)>e.args.size*s)return!1;if(e.args.y>t.args.y&&Math.abs(t.args.y-e.args.y)>t.args.size*u)return!1;if(t.args.solid){var l=t.args.size*u;-40+c<-l&&Math.abs(i)-n<r&&Math.abs(a)-n<o&&(e.args.y=t.args.y+l,e.ySpeed=e.ySpeed>0?e.ySpeed:0,e.ySpeed||(e.grounded=!0)),e.args.y<t.args.y+l&&(Math.abs(i/this.args.w)>Math.abs(a/this.args.d)?(e.args.x=t.args.x-r*Math.sign(i),e.xSpeed=Math.sign(e.xSpeed)!==Math.sign(i)?e.xSpeed:0):(e.args.z=t.args.z-o*Math.sign(a),e.zSpeed=Math.sign(e.zSpeed)!==Math.sign(a)?e.zSpeed:0))}return!0}},{key:"getSlope",value:function(e,t){return 1}},{key:"rotateSprite",value:function(e,t,n){var r=e/100,i=0;Math.cos(r*Math.PI),Math.sin(r*Math.PI),n>0&&(i+=Math.sign(n)),t&&(i+=-Math.sign(n||-1)*Math.sign(Math.abs(t)>Math.abs(n)?t:0)/2),i>1&&(i-=2),i<-1&&(i+=2),t||n?(this.args.walking=!0,this.args.rad=(i+r)*Math.PI,this.args.rot=100*i+e,this.setFace(e)):this.args.walking=!1}},{key:"setFace",value:function(e){var t,n=e+-this.args.rot;n>100&&(n-=200),n<-100&&(n+=200),t=n>=75||n<=-75?"front":n>25?"left":n<-25?"right":"back",this.args.face=t}},{key:"spray",value:function(e){var t=new i.Tag('<div class = "spray">');e.target.appendChild(t.node),t.style({left:e.offsetX+"px",top:e.offsetY+"px"}),console.log(e,e.target),window.showOpenFilePicker({types:[{description:"Images",accept:{"image/*":[".png",".gif",".jpeg",".jpg"]}}],excludeAcceptAllOption:!0,multiple:!1}).then(function(e){return e[0].getFile()}).then(function(e){return URL.createObjectURL(e)}).then(function(e){console.log(e),t.style({backgroundImage:"url(".concat(e,")")})})}}])&&u(n.prototype,r),s}(o.View);e.Cube=h}),require.register("cubes/Cubes.js",function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(e,"__esModule",{value:!0}),e.Cubes=void 0;var i=t("curvature/base/Bindable"),o=t("curvature/input/Gamepad"),a=t("curvature/input/Keyboard"),s=t("curvature/base/View"),u=t("matrix-api/Matrix"),c=(t("./Cube"),t("./Box"),t("./Wall"),t("./Slope"),t("./Barrel"),t("./BarrelHole"),t("./Coin"),t("./Chicken"),t("./Player")),l=t("./Other"),f=t("./OctCell"),d=t("../chat/Chat");function p(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return v(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?v(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function h(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function y(e,t){return(y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=w(e);if(t){var i=w(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return m(this,n)}}function m(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return g(e)}function g(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function w(e){return(w=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function O(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var x=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&y(e,t)}(v,e);var n,r,s=b(v);function v(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,v);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];O(g(e=s.call.apply(s,[this].concat(r))),"template",t("./main.html")),O(g(e),"matrix",new u.Matrix),O(g(e),"mainCube",new c.Player({css:"sean main",main:!0,x:-8,y:1024,z:0},g(e))),O(g(e),"octCell",new f.OctCell({x:0,y:0,z:0},{x:250,y:3200,z:100})),O(g(e),"others",new Map),window.octCell=e.octCell,e.args.roomId="!gThNCOwMwODTVUMrTe:matrix.org",(e.args.chat=new d.Chat).addEventListener("send",function(t){e.args.loggedIn&&(e.mainCube.showQuip(t.detail.input),e.matrix.putEvent(e.args.roomId,"m.room.message",{msgtype:"m.text",body:t.detail.input}).catch(function(e){return console.error(e)}))});var h=function(t){e.args.loggedIn&&e.matrix.putEvent(e.args.roomId,"m.cubes3d.walk",{msgtype:"m.text",body:"",walkTo:{rot:String(e.mainCube.args.rot),x:String(e.mainCube.args.x),y:String(e.mainCube.args.y),z:String(e.mainCube.args.z)}}).catch(function(e){return console.error(e)})};e.mainCube.addEventListener("start-moving",function(e){return h()}),e.mainCube.addEventListener("keep-moving",function(e){return h()}),e.mainCube.addEventListener("stop-moving",function(e){return h()}),e.args.xBound=e.octCell.box.size.x,e.args.zBound=e.octCell.box.size.z,e.listen(document,"pointerlockchange",function(t){if(!document.pointerLockElement)return e.cancelLock&&e.cancelLock(),e.cancelLock=!1,e.cancelScroll&&e.cancelScroll(),void(e.cancelScroll=!1);e.cancelLock=e.listen(document,"mousemove",function(t){return e.mouseMoveLocked(t)},!1),e.cancelScroll=e.listen(document,"mousewheel",function(t){return e.mouseScrollLocked(t)},!1)});var y=e.keyboard=a.Keyboard.get();y.listening=!0,e.onRemove(function(){return y.listening=!1}),o.Gamepad.getPad({keys:{Space:0,KeyW:12,KeyA:14,KeyS:13,KeyD:15,ArrowUp:12,ArrowDown:13,ArrowLeft:14,ArrowRight:15},keyboard:y,index:0,deadZone:.175}).then(function(t){e.gamepad=t}),e.args.x3d=-2,e.args.y3d=0,e.args.z3d=18,e.args.x3dInput=-2,e.args.y3dInput=0,e.args.z3dInput=18,e.args.xCam3d=0,e.args.yCam3d=-64,e.args.zCam3d=240,e.args.xCam3dInput=0,e.args.yCam3dInput=-64,e.args.zCam3dInput=220,e.args.xCamTilt3d=-5,e.args.yCamTilt3d=75,e.args.zCamTilt3d=0,e.args.xCamTilt3dInput=-25,e.args.yCamTilt3dInput=-75,e.args.zCamTilt3dInput=0,e.args.cancelScroll=null,e.args.cancelLock=null,e.args.outlines=!0,e.args.paused=0,e.args.frame=0,e.args.lockThrottle=0,e.args.loggedIn=!1,e.args.cubes=[e.mainCube];var b,w=p(e.args.cubes);try{for(w.s();!(b=w.n()).done;){var x=b.value,k={x:x.args.x,y:x.args.y,z:x.args.z};e.octCell.insert(i.Bindable.make(x),k)}}catch(e){w.e(e)}finally{w.f()}return e.args.exterior=!1,m(e,i.Bindable.make(g(e)))}return n=v,(r=[{key:"attached",value:function(){var e=this,t=this.onFrame(function(){return e.mainLoop()});this.onRemove(t)}},{key:"mainLoop",value:function(){if(this.takeInput(),this.pauseThrottle>0&&this.pauseThrottle--,this.paused>1)this.paused--;else if(this.paused)return this.syncToInput("xCam3d"),this.syncToInput("yCam3d"),this.syncToInput("zCam3d"),this.syncToInput("xCamTilt3d"),this.syncToInput("yCamTilt3d"),void this.syncToInput("zCamTilt3d");var e=this.args;e.frame++,e.outlines=this.args.zCam3d>-150,e.coinCount=this.mainCube.args.coinCount;var t,n=p(this.args.cubes);try{for(n.s();!(t=n.n()).done;){var r=t.value;r.sleeping||r.updateStart()}}catch(e){n.e(e)}finally{n.f()}var i,o=p(this.args.cubes);try{for(o.s();!(i=o.n()).done;){var a=i.value;if(!a.sleeping){var s,u={x:a.args.x,y:a.args.y,z:a.args.z},c={x:a.args.size/8,y:8*a.args.size,z:a.args.size/8},l=!1,f=p(this.octCell.select(u,c));try{for(f.s();!(s=f.n()).done;){var d=s.value;d.sleeping||a.checkCollision(d)&&(d.collide(a),a.args.solid&&(l=!0))}}catch(e){f.e(e)}finally{f.f()}l||(a.grounded=!1)}}}catch(e){o.e(e)}finally{o.f()}var v,h=p(this.args.cubes);try{for(h.s();!(v=h.n()).done;){var y=v.value;y.sleeping||(y.setFace(this.args.yCamTilt3d),y.update(),y.args.x>.5*this.octCell.box.size.x&&(y.args.x=.5*this.octCell.box.size.x),y.args.z>.5*this.octCell.box.size.z&&(y.args.z=.5*this.octCell.box.size.z),y.args.x<.5*-this.octCell.box.size.x&&(y.args.x=.5*-this.octCell.box.size.x),y.args.z<.5*-this.octCell.box.size.z&&(y.args.z=.5*-this.octCell.box.size.z))}}catch(e){h.e(e)}finally{h.f()}var b,m=p(this.args.cubes);try{for(m.s();!(b=m.n()).done;){var g=b.value;g.sleeping||this.octCell.move(g,{x:g.args.x,y:g.args.y,z:g.args.z})}}catch(e){m.e(e)}finally{m.f()}e.x3d=Number(this.mainCube.args.x).toFixed(3),e.y3d=Number(this.mainCube.args.y).toFixed(3),e.z3d=Number(this.mainCube.args.z).toFixed(3),this.syncToInput("xCam3d"),this.syncToInput("yCam3d"),this.syncToInput("zCam3d"),this.syncToInput("xCamTilt3d"),this.syncToInput("yCamTilt3d"),this.syncToInput("zCamTilt3d")}},{key:"takeInput",value:function(){-1===this.keyboard.keys.t&&this.args.chat.args.outbox.tags.input.focus(),-2!==this.keyboard.keys.o||this.pauseThrottle||(this.paused=this.paused?2:-1),-2!==this.keyboard.keys.p||this.pauseThrottle||(this.paused=this.paused?0:-1,this.paused&&(this.pauseThrottle=30));var e={xAxis:0,yAxis:0,aAxis:0,bAxis:0,b:[]};if(this.keyboard.keys.w>0||this.keyboard.keys.ArrowUp>0?e.yAxis=-1:(this.keyboard.keys.s>0||this.keyboard.keys.ArrowDown>0)&&(e.yAxis=1),this.keyboard.keys.a>0||this.keyboard.keys.ArrowLeft>0?e.xAxis=-1:(this.keyboard.keys.d>0||this.keyboard.keys.ArrowRight>0)&&(e.xAxis=1),e.b[0]=this.keyboard.keys[" "],this.gamepad)for(var t in this.gamepad.readInput(),e.xAxis=e.xAxis||Number(this.gamepad.axes[0].magnitude),e.yAxis=e.yAxis||Number(this.gamepad.axes[1].magnitude),e.aAxis=e.aAxis||Number(this.gamepad.axes[2].magnitude),e.bAxis=e.bAxis||Number(this.gamepad.axes[3].magnitude),this.gamepad.buttons)e.b[t]=e.b[t]||this.gamepad.buttons[t].delta;this.tiltCamera(e),this.paused||(this.mainCube.takeInput(this.args.yCamTilt3d,e),this.mainCube.rotateSprite(this.args.yCamTilt3d,e.xAxis,e.yAxis)),this.keyboard.update()}},{key:"tiltCamera",value:function(e){this.args.yCamTilt3dInput=Number(this.args.yCamTilt3dInput)+1.75*e.aAxis,this.args.xCamTilt3dInput=Number(this.args.xCamTilt3dInput)+1.25*e.bAxis,this.args.xCamTilt3dInput=Math.max(this.args.zCam3d<-150?-25:-50,this.args.xCamTilt3dInput),this.args.xCamTilt3dInput=Math.min(this.args.zCam3d<-150?25:0,this.args.xCamTilt3dInput),this.args.xCamTilt3dInput=Math.max(this.args.zCam3d<-150?-25:-50,this.args.xCamTilt3dInput),this.args.xCamTilt3dInput=Math.min(this.args.zCam3d<-150?25:0,this.args.xCamTilt3dInput),this.args.yCamTilt3dInput>100&&(this.args.yCamTilt3dInput-=200,this.args.yCamTilt3d-=200),this.args.yCamTilt3dInput<-100&&(this.args.yCamTilt3dInput+=200,this.args.yCamTilt3d+=200),this.args.yCam3dInput>64&&(this.args.yCam3dInput=64),this.args.zCam3dInput<-220&&(this.args.zCam3dInput=-220)}},{key:"lockMouse",value:function(e){2===e.which&&(e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),Date.now()-this.lockThrottle<350||(this.lockThrottle=Date.now(),document.pointerLockElement?document.exitPointerLock():e.currentTarget.requestPointerLock()))}},{key:"mouseMoveLocked",value:function(e){var t=5,n=3.5;this.args.zCam3d<-150&&(t=.95,n=1),this.args.xCamTilt3dInput=Number(this.args.xCamTilt3dInput)-Math.min(t,Math.abs(e.movementY))*Math.sign(e.movementY),this.args.yCamTilt3dInput=Number(this.args.yCamTilt3dInput)+Math.min(n,Math.abs(e.movementX))*Math.sign(e.movementX),this.args.yCamTilt3dInput>100&&(this.args.yCamTilt3dInput-=200,this.args.yCamTilt3d-=200),this.args.yCamTilt3dInput<-100&&(this.args.yCamTilt3dInput+=200,this.args.yCamTilt3d+=200)}},{key:"mouseScrollLocked",value:function(e){this.args.zCam3dInput+=.25*e.deltaY,this.args.yCam3dInput+=.25*e.deltaX}},{key:"syncToInput",value:function(e){var t=this.args,n=e+"Input";t[n]=Number(t[n]),t[e]=Number(t[e]),Math.abs(t[n]-t[e])>.001?t[e]+=.27*(t[n]-t[e]):t[e]=t[n]}},{key:"login",value:function(e){var t=this,n=location.origin+"/accept-sso";this.matrix.initSso(n),this.loginListener||(this.loginListener=this.listen(this.matrix,"logged-in",function(e){t.matrix.addEventListener("matrix-event",function(e){return t.handleMatrixEvent(e)}),t.matrix.listenForServerEvents(),t.matrix.joinRoom(t.args.roomId),t.matrix.whoAmI().then(function(e){t.args.loggedIn=!0,t.args.userId=e.user_id,t.myId=t.args.chat.args.myId=e.user_id})}))}},{key:"handleMatrixEvent",value:function(e){var t,n=e.detail.user_id;n&&n!==this.myId&&(this.others.has(n)?t=this.others.get(n):(t=new l.Other({css:"sean"},this),this.others.set(n,t),this.args.cubes.push(t)),"m.room.message"===e.detail.type&&(t.showQuip(e.detail.content.body),this.args.chat.handleMessage(e)),"m.cubes3d.walk"===e.detail.type&&(Object.assign(t.args,{}),t.target.x=Number(e.detail.content.walkTo.x),t.target.z=Number(e.detail.content.walkTo.z)))}}])&&h(n.prototype,r),v}(s.View);e.Cubes=x,O(x,"helpText","CUBES.")}),require.register("cubes/OctCell.js",function(e,t,n){"use strict";function r(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){u=!0,a=e},f:function(){try{s||null==n.return||n.return()}finally{if(u)throw a}}}}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Object.defineProperty(e,"__esModule",{value:!0}),e.OctCell=void 0;var c=Symbol("CellRef"),l=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:0,y:0,z:0},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{x:0,y:0,z:0};o(this,e),u(this,"position",{}),u(this,"size",{}),this.position.x=t.x,this.position.y=t.y,this.position.z=t.z,this.size.x=n.x,this.size.y=n.y,this.size.z=n.z,Object.seal(this)}return s(e,[{key:"contains",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:0,y:0,z:0},t=this.position.x-this.size.x/2,n=this.position.x+this.size.x/2;if(e.x<t||e.x>n)return!1;var r=this.position.y-this.size.y/2,i=this.position.y+this.size.y/2;if(e.y<r||e.y>i)return!1;var o=this.position.z-this.size.z/2,a=this.position.z+this.size.z/2;return!(e.z<o||e.z>a)}}]),e}(),f=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:0,y:0,z:0},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{x:0,y:0,z:0},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;o(this,e),u(this,"position",{}),u(this,"size",{}),u(this,"divided",!1),u(this,"parent",null),u(this,"leafPoint",{x:null,y:null,z:null}),u(this,"leafRef",null),u(this,"ldf",null),u(this,"rdf",null),u(this,"luf",null),u(this,"ruf",null),u(this,"ldb",null),u(this,"rdb",null),u(this,"lub",null),u(this,"rub",null),u(this,"cells",[]),this.box=new l(t,n),this.parent=r,Object.seal(this)}return s(e,[{key:"empty",value:function(){if(!this.divided)return!this.leafRef;var e,t=r(this.cells);try{for(t.s();!(e=t.n()).done;)if(!e.value.empty())return!1}catch(e){t.e(e)}finally{t.f()}return!0}},{key:"insert",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{x:0,y:0,z:0};if(!this.contains(t))return!1;if(!this.leafRef&&!this.divided)return this.leafPoint.x=t.x,this.leafPoint.y=t.y,this.leafPoint.z=t.z,this.leafRef=e,this.leafRef[c]=this,!0;this.divided||this.divide();var n,i=r(this.cells);try{for(i.s();!(n=i.n()).done;){if(n.value.insert(e,t))return!0}}catch(e){i.e(e)}finally{i.f()}return!1}},{key:"move",value:function(e,t){var n=e[c];if(n){if(n.leafPoint.x===t.x&&n.leafPoint.y===t.y&&n.leafPoint.z===t.z)return;e[c]=null,n.leafRef=null,n.parent&&n.parent.join()}this.insert(e,t)}},{key:"remove",value:function(e){var t=e[c];t&&(e[c]=null,t.leafRef=null,t.parent&&t.parent.join())}},{key:"join",value:function(){if(!this.empty())return!1;var e,t=null,n=r(this.cells);try{for(n.s();!(e=n.n()).done;){var i=e.value;if(!i.empty()){if(t)return!1;t=i}}}catch(e){n.e(e)}finally{n.f()}this.ldf=null,this.rdf=null,this.luf=null,this.ruf=null,this.ldb=null,this.rdb=null,this.lub=null,this.rub=null,this.cells=[],this.divided=!1,t&&this.insert(t.leafRef),this.parent&&this.parent.join()}},{key:"divide",value:function(){if(this.divided)return!1;var e=this.box.position,t=this.box.size;if(this.ldf=new this.constructor({x:e.x-t.x/4,y:e.y-t.y/4,z:e.z+t.z/4},{x:t.x/2,y:t.y/2,z:t.z/2},this),this.rdf=new this.constructor({x:e.x+t.x/4,y:e.y-t.y/4,z:e.z+t.z/4},{x:t.x/2,y:t.y/2,z:t.z/2},this),this.luf=new this.constructor({x:e.x-t.x/4,y:e.y+t.y/4,z:e.z+t.z/4},{x:t.x/2,y:t.y/2,z:t.z/2},this),this.ruf=new this.constructor({x:e.x+t.x/4,y:e.y+t.y/4,z:e.z+t.z/4},{x:t.x/2,y:t.y/2,z:t.z/2},this),this.ldb=new this.constructor({x:e.x-t.x/4,y:e.y-t.y/4,z:e.z-t.z/4},{x:t.x/2,y:t.y/2,z:t.z/2},this),this.rdb=new this.constructor({x:e.x+t.x/4,y:e.y-t.y/4,z:e.z-t.z/4},{x:t.x/2,y:t.y/2,z:t.z/2},this),this.lub=new this.constructor({x:e.x-t.x/4,y:e.y+t.y/4,z:e.z-t.z/4},{x:t.x/2,y:t.y/2,z:t.z/2},this),this.rub=new this.constructor({x:e.x+t.x/4,y:e.y+t.y/4,z:e.z-t.z/4},{x:t.x/2,y:t.y/2,z:t.z/2},this),this.cells.push(this.ldf,this.rdf,this.luf,this.ruf,this.ldb,this.rdb,this.lub,this.rub),this.divided=!0,!this.leafRef)return!0;var n,i=r(this.cells);try{for(i.s();!(n=i.n()).done;)if(n.value.insert(this.leafRef,this.leafPoint))return this.leafRef=null,!0}catch(e){i.e(e)}finally{i.f()}}},{key:"contains",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:0,y:0,z:0};return this.box.contains(e)}},{key:"select",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:0,y:0,z:0},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{x:0,y:0,z:0};return this.empty()?[]:t.x/2+this.box.size.x/2<Math.abs(e.x-this.box.position.x)?[]:t.y/2+this.box.size.y/2<Math.abs(e.y-this.box.position.y)?[]:t.z/2+this.box.size.z/2<Math.abs(e.z-this.box.position.z)?[]:this.divided?this.cells.map(function(n){return n.select(e,t)}).flat():this.leafRef?[this.leafRef]:[]}}]),e}();e.OctCell=f}),require.register("cubes/Other.js",function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(e,"__esModule",{value:!0}),e.Other=void 0;var i=t("./Cube");function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=l(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}}).apply(this,arguments)}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return c(e)}function c(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}t("./Coin");var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(i,e);var t,n,r=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=l(e);if(t){var i=l(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return u(this,n)}}(i);function i(e,t){var n,o,a;return function(e,t){if(!(e instanceof i))throw new TypeError("Cannot call a class as a function")}(this),0,(a="coinCooldown")in(o=c(n=r.call(this,e,t)))?Object.defineProperty(o,a,{value:0,enumerable:!0,configurable:!0,writable:!0}):o[a]=0,n.args.css=n.args.css||"sean main",n.args.quips=[],n.target={},n.target.x=0,n.target.y=0,n.target.z=0,n}return t=i,(n=[{key:"update",value:function(e){this.args.x-this.target.x&&(this.xSpeed=.3*-Math.sign(this.args.x-this.target.x)),this.args.z-this.target.z&&(this.zSpeed=.3*-Math.sign(this.args.z-this.target.z)),Math.abs(this.args.x-this.target.x)<.3&&(this.args.x=this.target.x,this.xSpeed=0),Math.abs(this.args.z-this.target.z)<.3&&(this.args.z=this.target.z,this.zSpeed=0),a(l(i.prototype),"update",this).call(this,e),this.xSpeed||this.zSpeed?this.args.walking=!0:this.args.walking=!1}},{key:"showQuip",value:function(e){var t=this.args.quips;for(t.push(e);t.length>3;)t.shift();this.onTimeout(3750,function(){return t.shift()})}},{key:"setFace",value:function(e){this.moving&&(this.args.rot=Math.atan2(this.zSpeed,this.xSpeed)/Math.PI),a(l(i.prototype),"setFace",this).call(this,e+-(100*this.args.rot-50))}}])&&o(t.prototype,n),i}(i.Cube);e.Other=f}),require.register("cubes/Player.js",function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(e,"__esModule",{value:!0}),e.Player=void 0;var i=t("./Cube"),o=t("./Coin");function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=f(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}}).apply(this,arguments)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return l(e)}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var d=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(i,e);var t,n,r=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=f(e);if(t){var i=f(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return c(this,n)}}(i);function i(e,t){var n,o,a;return function(e,t){if(!(e instanceof i))throw new TypeError("Cannot call a class as a function")}(this),0,(a="coinCooldown")in(o=l(n=r.call(this,e,t)))?Object.defineProperty(o,a,{value:0,enumerable:!0,configurable:!0,writable:!0}):o[a]=0,n.args.css=n.args.css||"sean main",n.coinCollect1=new Audio("/coin1.wav"),n.coinCollect2=new Audio("/coin2.wav"),n.coinCollect3=new Audio("/coin3.wav"),n.coinCollect1.currentTime=0,n.coinCollect2.currentTime=0,n.coinCollect3.currentTime=0,n.coinCollect1.volume=.4,n.coinCollect2.volume=.3,n.coinCollect3.volume=.25,n.args.quips=[],n}return t=i,(n=[{key:"update",value:function(e){s(f(i.prototype),"update",this).call(this,e),this.coinCooldown=Math.max(0,-1+this.coinCooldown)}},{key:"collide",value:function(e){s(f(i.prototype),"collide",this).call(this,e),e instanceof o.Coin&&e.args.gone}},{key:"collect",value:function(e){this.coinCooldown>=75?(this.coinCollect3.currentTime=0,this.coinCollect3.play()):this.coinCooldown>40?(this.coinCollect2.currentTime=0,this.coinCollect2.play()):(this.coinCollect1.currentTime=0,this.coinCollect1.play()),this.coinCooldown+=30,this.coinCooldown>160&&(this.coinCooldown=160)}},{key:"showQuip",value:function(e){var t=this.args.quips;for(t.push(e);t.length>3;)t.shift();this.onTimeout(3750,function(){return t.shift()})}}])&&a(t.prototype,n),i}(i.Cube);e.Player=d}),require.register("cubes/Slope.js",function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function a(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=c(e);if(t){var i=c(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return s(this,n)}}function s(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return u(e)}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(e,"__esModule",{value:!0}),e.Slope=void 0;var l=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&o(e,t)}(c,t("./Cube").Cube);var n,r,s=a(c);function c(e,n){var r,i,o,a;return function(e,t){if(!(e instanceof c))throw new TypeError("Cannot call a class as a function")}(this),i=u(r=s.call(this,e,n)),o="template",a=t("./slope.tmp"),o in i?Object.defineProperty(i,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):i[o]=a,r.args.mass=1/0,r}return n=c,(r=[{key:"getSlope",value:function(e,t){this.args.z;var n=this.args.size/32*this.args.d;return Math.max(0,Math.min(1,.5+(this.args.z-t)/n))}}])&&i(n.prototype,r),c}();e.Slope=l}),require.register("cubes/Wall.js",function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return a(e)}function a(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Object.defineProperty(e,"__esModule",{value:!0}),e.Wall=void 0;var c=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(r,t("./Cube").Cube);var n=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=s(e);if(t){var i=s(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return o(this,n)}}(r);function r(e,i){var o;return function(e,t){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}(this),e.w=e.w||2,e.d=e.d||.001,u(a(o=n.call(this,e,i)),"template",t("./wall.tmp")),u(a(o),"gravity",0),o.args.css="box wall",o.args.mass=1/0,o}return r}();e.Wall=c}),require.register("cubes/barrel-hole.tmp.html",function(e,t,n){n.exports='<div\n\tstyle = "--x:[[x]];--y:[[y]];--z:[[z]];\n\t--w: [[w]]; --h:  [[h]]; --d:  [[d]];\n\t--rad: [[rad]]; --size: [[size]];"\n\tdata-colliding = "[[colliding]]"\n\tdata-walking   = "[[walking]]"\n\tdata-state     = "[[state]]"\n\tclass          = "cube [[css]]"\n>\n\t<div class = "texture top"></div>\n\t<div class = "texture indicator"></div>\n</div>\n'}),require.register("cubes/box.html",function(e,t,n){n.exports='<div\n\tstyle = "--x:[[x]];--y:[[y]];--z:[[z]];\n\t--w: [[w]]; --h:  [[h]]; --d:  [[d]];\n\t--rad: [[rad]]; --size: [[size]];"\n\n\tdata-colliding = "[[colliding]]"\n\tdata-interior  = "[[interior]]"\n\tdata-walking   = "[[walking]]"\n\tdata-solid     = "[[solid]]"\n\tdata-state     = "[[state]]"\n\tclass          = "cube [[css]]"\n\tcv-on          = "click:spray(event)"\n>\n\t<div class = "texture bottom"></div>\n\t<div class = "texture top"></div>\n\t<div class = "texture front"></div>\n\t<div class = "texture back">\n\t\t\x3c!-- <iframe src="https://www.youtube.com/embed/HW-heSo9580?start=644" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe> --\x3e\n\t</div>\n\t<div class = "texture left">\n\t\t\x3c!-- <div class = "frame">\n\t\t\t<p>This is only a test form</p>\n\t\t\tUsername:\n\t\t\t<input type = "text">\n\t\t\tPassword:\n\t\t\t<input type = "password">\n\t\t\t<input type = "submit">\n\t\t</div> --\x3e\n\t</div>\n\t<div class = "texture right">\n\t\t\x3c!-- <iframe src="http://pixel-physics.seanmorr.is?map=empty-zone.json"> --\x3e\n\t\t\x3c!-- <iframe class = "virtual-screen" src="http://localhost:3333/"> --\x3e\n\t</div>\n\t<div class = "texture direction"></div>\n\t<div class = "texture indicator"></div>\n\t<div class = "texture flat face-[[face]]"></div>\n</div>\n'}),require.register("cubes/coin.html",function(e,t,n){n.exports='<div\n\tstyle = "--x:[[x]];--y:[[y]];--z:[[z]];\n\t--w: [[w]]; --h:  [[h]]; --d:  [[d]];\n\t--rad: [[rad]]; --size: [[size]];"\n\tdata-colliding = "[[colliding]]"\n\tdata-walking   = "[[walking]]"\n\tdata-state     = "[[state]]"\n\tclass          = "cube [[css]]"\n>\n\t<div class = "texture flat face-[[face]]"></div>\n</div>\n'}),require.register("cubes/cube.html",function(e,t,n){n.exports='<div\n\tstyle = "--x:[[x]];--y:[[y]];--z:[[z]];\n\t--w: [[w]]; --h:  [[h]]; --d:  [[d]];\n\t--rad: [[rad]]; --size: [[size]];"\n\n\n\tdata-colliding = "[[colliding]]"\n\tdata-walking   = "[[walking]]"\n\tdata-state     = "[[state]]"\n\tclass          = "cube [[css]]"\n>\n\t<div class = "texture top"></div>\n\t<div class = "texture front"></div>\n\t<div class = "texture back"></div>\n\t<div class = "texture left"></div>\n\t<div class = "texture right"></div>\n\t<div class = "texture bottom"></div>\n\t<div class = "texture direction"></div>\n\t<div class = "texture indicator"></div>\n\t<div class = "texture flat sprite face-[[face]]"></div>\n\t<div class = "texture flat speech-bubble" cv-each = "quips:quip">\n\t\t<p>[[quip]]</p>\n\t</div>\n</div>\n'}),require.register("cubes/main.html",function(e,t,n){n.exports='<div\n\tcv-on = "mouseup:lockMouse"\n\tclass = "liquid inset frame cubes"\n\tdata-outlines = "[[outlines]]"\n\tdata-exterior = [[exterior]]\n\tstyle = "--x3d:[[x3d]];--y3d:[[y3d]];--z3d:[[z3d]];--xCam3d:[[xCam3d]];--yCam3d:[[yCam3d]];--zCam3d:[[zCam3d]];--xCamTilt3d:[[xCamTilt3d]];--yCamTilt3d:[[yCamTilt3d]];--zCamTilt3d:[[zCamTilt3d]];--xBound:[[xBound]];--zBound:[[zBound]];"\n>\n\t<div class = "world">\n\n\t\t<span class = "contents" cv-each = "cubes:cube">\n\t\t\t[[cube]]\n\t\t</span>\n\n\t\t<div class = "ground texture">\n\t\t\t<div class = "panel-row">\n\t\t\t\t<div class = "panel"></div>\n\t\t\t\t<div class = "panel"></div>\n\t\t\t\t\x3c!-- <div class = "panel"></div>\n\t\t\t\t<div class = "panel"></div> --\x3e\n\t\t\t</div>\n\t\t\t<div class = "panel-row">\n\t\t\t\t<div class = "panel"></div>\n\t\t\t\t<div class = "panel"></div>\n\t\t\t\t\x3c!-- <div class = "panel"></div>\n\t\t\t\t<div class = "panel"></div> --\x3e\n\t\t\t</div>\n\t\t\t<div class = "panel-row">\n\t\t\t\t<div class = "panel"></div>\n\t\t\t\t<div class = "panel"></div>\n\t\t\t\t\x3c!-- <div class = "panel"></div>\n\t\t\t\t<div class = "panel"></div> --\x3e\n\t\t\t</div>\n\t\t\t<div class = "panel-row">\n\t\t\t\t<div class = "panel"></div>\n\t\t\t\t<div class = "panel"></div>\n\t\t\t\t\x3c!-- <div class = "panel"></div>\n\t\t\t\t<div class = "panel"></div> --\x3e\n\t\t\t</div>\n\n\t\t\t<div class = "ground texture collision-zone"></div>\n\t\t</div>\n\n\n\n\t</div>\n\n<div class = "hud"></div>\n\n<div class = "coin-count">[[coinCount]]</div>\n<div class = "frame">[[frame]]</div>\n\n</div>\n\n[[chat]]\n\n<div class = "toolbar" cv-if = "!loggedIn">\n\t<button cv-on = "click:login">login</button>\n</div>'}),require.register("cubes/slope.svg",function(e,t,n){n.exports='<?xml version="1.0" encoding="UTF-8" standalone="no"?>\n<svg\n   xmlns:dc="http://purl.org/dc/elements/1.1/"\n   xmlns:cc="http://creativecommons.org/ns#"\n   xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"\n   xmlns:svg="http://www.w3.org/2000/svg"\n   xmlns="http://www.w3.org/2000/svg"\n   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"\n   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"\n   width="128"\n   height="128"\n   viewBox="0 0 33.866666 33.866666"\n   version="1.1"\n   id="svg8"\n   inkscape:version="1.0.2 (e86c870879, 2021-01-15)"\n   sodipodi:docname="slope.svg">\n  <defs\n     id="defs2" />\n  <sodipodi:namedview\n     id="base"\n     pagecolor="#ffffff"\n     bordercolor="#666666"\n     borderopacity="1.0"\n     inkscape:pageopacity="0.0"\n     inkscape:pageshadow="2"\n     inkscape:zoom="3.959798"\n     inkscape:cx="61.61944"\n     inkscape:cy="64.664728"\n     inkscape:document-units="mm"\n     inkscape:current-layer="layer1"\n     inkscape:document-rotation="0"\n     showgrid="false"\n     units="px"\n     fit-margin-top="0"\n     fit-margin-left="0"\n     fit-margin-right="0"\n     fit-margin-bottom="0"\n     inkscape:window-width="1920"\n     inkscape:window-height="1026"\n     inkscape:window-x="1050"\n     inkscape:window-y="31"\n     inkscape:window-maximized="1" />\n  <metadata\n     id="metadata5">\n    <rdf:RDF>\n      <cc:Work\n         rdf:about="">\n        <dc:format>image/svg+xml</dc:format>\n        <dc:type\n           rdf:resource="http://purl.org/dc/dcmitype/StillImage" />\n        <dc:title></dc:title>\n      </cc:Work>\n    </rdf:RDF>\n  </metadata>\n  <g\n     inkscape:label="Layer 1"\n     inkscape:groupmode="layer"\n     id="layer1">\n    <path\n       id="rect28"\n       style="fill:#000000;fill-opacity:0.9;stroke:none;stroke-width:0.0896054"\n       d="M 33.866667,0 V 33.866667 H 0 Z"\n       sodipodi:nodetypes="cccc" />\n  </g>\n</svg>\n'}),require.register("cubes/slope.tmp.html",function(e,t,n){n.exports='<div\n\tstyle = "--x:[[x]];--y:[[y]];--z:[[z]];\n\t--w: [[w]]; --h:  [[h]]; --d:  [[d]];\n\t--rad: [[rad]]; --size: [[size]];"\n\tdata-colliding = "[[colliding]]"\n\tdata-walking   = "[[walking]]"\n\tdata-solid     = "[[solid]]"\n\tdata-state     = "[[state]]"\n\tclass          = "cube slope [[css]]"\n\tcv-on          = "click:spray(event)"\n>\n\t<div class = "texture top"></div>\n\t<div class = "texture front"></div>\n\t<div class = "texture back">\n\t\t\x3c!-- <iframe src="https://www.youtube.com/embed/HW-heSo9580?start=644" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe> --\x3e\n\t</div>\n\t<div class = "texture left">\n\t\t\x3c!-- <div class = "frame">\n\t\t\t<p>This is only a test form</p>\n\t\t\tUsername:\n\t\t\t<input type = "text">\n\t\t\tPassword:\n\t\t\t<input type = "password">\n\t\t\t<input type = "submit">\n\t\t</div> --\x3e\n\t</div>\n\t<div class = "texture right">\n\t\t\x3c!-- <iframe src="http://pixel-physics.seanmorr.is?map=empty-zone.json"> --\x3e\n\t\t\x3c!-- <iframe class = "virtual-screen" src="http://localhost:3333/"> --\x3e\n\t</div>\n\t\x3c!-- <div class = "texture direction"></div> --\x3e\n\t\x3c!-- <div class = "texture indicator"></div> --\x3e\n\t\x3c!-- <div class = "texture flat face-[[face]]"></div> --\x3e\n</div>\n'}),require.register("cubes/wall.tmp.html",function(e,t,n){n.exports='<div\n\tstyle = "--x:[[x]];--y:[[y]];--z:[[z]];\n\t--w: [[w]]; --h:  [[h]]; --d:  [[d]];\n\t--rad: [[rad]]; --size: [[size]];"\n\n\tdata-colliding = "[[colliding]]"\n\tdata-walking   = "[[walking]]"\n\tdata-state     = "[[state]]"\n\tclass          = "cube [[css]]"\n\tcv-on          = "click:spray(event)"\n>\n\t\x3c!-- <div class = "texture top"></div> --\x3e\n\t<div class = "texture front">\n\t\t<div class = "billboard">\n\t\t\t<div>[[billboard]]</div>\n\t\t</div>\n\t</div>\n\t<div class = "texture back"></div>\n\t<div class = "texture left"></div>\n\t<div class = "texture right"></div>\n\t\x3c!-- <div class = "texture bottom"></div>\n\t<div class = "texture direction"></div>\n\t<div class = "texture indicator"></div>\n\t<div class = "texture flat face-[[face]]"></div> --\x3e\n</div>\n'}),require.register("initialize.js",function(e,t,n){"use strict";t("curvature/base/View");var r=t("./cubes/Cubes"),i=t("matrix-api/Matrix");if("/accept-sso"!==location.pathname)globalThis.addEventListener("DOMContentLoaded",function(){(new r.Cubes).render(document.body)});else{var o=new i.Matrix("https://matrix.org/_matrix"),a=new URLSearchParams(location.search).get("loginToken");o.completeSso(a)}}),require.register("___globals___",function(e,t,n){})}(),require("___globals___");
